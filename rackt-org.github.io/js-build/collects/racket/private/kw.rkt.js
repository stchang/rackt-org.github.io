import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result382 = M0.make_struct_type_property($rjs_core.Symbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result382.getAt(0);var keyword_impersonator_p = let_result382.getAt(1);var keyword_impersonator_ref = let_result382.getAt(2);var keyword_procedure_impersonator_of = function(v823) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v823)!==false) {var if_res383 = keyword_impersonator_ref(v823)(v823);} else {var if_res383 = false;}return if_res383;};var let_result384 = M0.make_struct_type($rjs_core.Symbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result384.getAt(0);var mk_kw_proc = let_result384.getAt(1);var keyword_procedure_p = let_result384.getAt(2);var keyword_procedure_ref = let_result384.getAt(3);var keyword_procedure_set_bang_ = let_result384.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result385 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result385.getAt(0);var make_km = let_result385.getAt(1);var keyword_method_p = let_result385.getAt(2);var km_ref = let_result385.getAt(3);var km_set_bang_ = let_result385.getAt(4);var generate_arity_string = function(proc824) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result386 = procedure_keywords(proc824);var req825 = let_result386.getAt(0);var allowed826 = let_result386.getAt(1);var a827 = M0.procedure_arity(proc824);var keywords_desc828 = function(opt830, req831) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp392 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req831))!==false) {var if_res391 = M0.format($rjs_core.UString.make("an ~aargument"),opt830);} else {var if_res391 = M0.format($rjs_core.UString.make("~aarguments"),opt830);}if (M0.null_p(M0.cdr(req831))!==false) {var if_res390 = $rjs_core.UString.make("");} else {var if_res390 = $rjs_core.UString.make("s");}var tmp832 = M0.length(req831);if (M0.equal_p(tmp832,1)!==false) {var if_res389 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req831));} else {if (M0.equal_p(tmp832,2)!==false) {var if_res388 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req831),M0.cadr(req831));} else {var loop833 = function(req834) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req834))!==false) {var if_res387 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req834));} else {var if_res387 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req834),loop833(M0.cdr(req834)));}return if_res387;};var if_res388 = loop833(req831);}var if_res389 = if_res388;}return M0.format(temp392,if_res391,if_res390,if_res389);};var method_adjust829 = function(a835) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part836 = okm_p(proc824);if (or_part836!==false) {var if_res393 = or_part836;} else {var if_res393 = keyword_method_p(proc824);}if (if_res393!==false) {if (M0.zero_p(a835)!==false) {var if_res394 = 0;} else {var if_res394 = M0.sub1(a835);}var if_res395 = if_res394;} else {var if_res395 = a835;}return if_res395;};if (M0.number_p(a827)!==false) {var a837 = method_adjust829(a827);var if_res402 = M0.format($rjs_core.UString.make("~a"),a837);} else {if (M0.arity_at_least_p(a827)!==false) {var a838 = method_adjust829(M0.arity_at_least_value(a827));var if_res401 = M0.format($rjs_core.UString.make("at least ~a"),a838);} else {var if_res401 = $rjs_core.UString.make("a different number");}var if_res402 = if_res401;}if (M0.null_p(req825)!==false) {var if_res400 = $rjs_core.UString.make("");} else {var if_res400 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc828($rjs_core.UString.make(""),req825));}if (allowed826!==false) {var loop840 = function(req841, allowed842) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req841)!==false) {var if_res397 = allowed842;} else {if (M0.eq_p(M0.car(req841),M0.car(allowed842))!==false) {var if_res396 = loop840(M0.cdr(req841),M0.cdr(allowed842));} else {var if_res396 = M0.cons(M0.car(allowed842),loop840(req841,M0.cdr(allowed842)));}var if_res397 = if_res396;}return if_res397;};var others839 = loop840(req825,allowed826);if (M0.null_p(others839)!==false) {var if_res398 = $rjs_core.UString.make("");} else {var if_res398 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc828($rjs_core.UString.make("optional "),others839));}var if_res399 = if_res398;} else {var if_res399 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res402,if_res400,if_res399);};var let_result403 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result403.getAt(0);var make_optional_keyword_procedure = let_result403.getAt(1);var okp_p = let_result403.getAt(2);var okp_ref = let_result403.getAt(3);var okp_set_bang_ = let_result403.getAt(4);var let_result404 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result404.getAt(0);var make_optional_keyword_method = let_result404.getAt(1);var okm_p = let_result404.getAt(2);var okm_ref = let_result404.getAt(3);var okm_set_bang_ = let_result404.getAt(4);var let_result405 = M0.make_struct_type_property($rjs_core.Symbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result405.getAt(0);var named_keyword_procedure_p = let_result405.getAt(1);var keyword_procedure_name_plus_fail = let_result405.getAt(2);var let_result407 = M0.make_struct_type_property($rjs_core.Symbol.make("procedure"),function(v843, info_l844) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v843)!==false) {var if_res406 = M0.make_struct_field_accessor(M0.list_ref(info_l844,3),v843);} else {var if_res406 = false;}return if_res406;});var prop_procedure_accessor = let_result407.getAt(0);var procedure_accessor_p = let_result407.getAt(1);var procedure_accessor_ref = let_result407.getAt(2);var let_result408 = M0.make_struct_type_property($rjs_core.Symbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result408.getAt(0);var new_procedure_p = let_result408.getAt(1);var new_procedure_ref = let_result408.getAt(2);var let_result409 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v845) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v845,0);})));var struct_keyword_procedure_impersonator = let_result409.getAt(0);var make_kpp = let_result409.getAt(1);var keyword_procedure_impersonator_p = let_result409.getAt(2);var kpp_ref = let_result409.getAt(3);var kpp_set_bang_ = let_result409.getAt(4);var let_result410 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v846) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v846,0);})));var struct_keyword_method_impersonator = let_result410.getAt(0);var make_kmp = let_result410.getAt(1);var keyword_method_impersonator_p = let_result410.getAt(2);var kmp_ref = let_result410.getAt(3);var kmp_set_bang_ = let_result410.getAt(4);var let_result411 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v847) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v847,0);})));var struct_okpp = let_result411.getAt(0);var make_optional_keyword_procedure_impersonator = let_result411.getAt(1);var okpp_p = let_result411.getAt(2);var okpp_ref = let_result411.getAt(3);var okpp_set_bang_ = let_result411.getAt(4);var let_result412 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v848) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v848,0);})));var struct_okmp = let_result412.getAt(0);var make_optional_keyword_method_impersonator = let_result412.getAt(1);var okmp_p = let_result412.getAt(2);var okmp_ref = let_result412.getAt(3);var okmp_set_bang_ = let_result412.getAt(4);var let_result413 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result413.getAt(0);var make_kp_by_ae = let_result413.getAt(1);var kp_by_ae_p = let_result413.getAt(2);var kp_by_ae_ref = let_result413.getAt(3);var kp_by_ae_set_bang_ = let_result413.getAt(4);var let_result414 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result414.getAt(0);var make_km_by_ae = let_result414.getAt(1);var km_by_ae_p = let_result414.getAt(2);var km_by_ae_ref = let_result414.getAt(3);var km_by_ae_set_bang_ = let_result414.getAt(4);var let_result415 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result415.getAt(0);var make_kpi_by_ae = let_result415.getAt(1);var kpi_by_ae_p = let_result415.getAt(2);var kpi_by_ae_ref = let_result415.getAt(3);var kpi_by_ae_set_bang_ = let_result415.getAt(4);var let_result416 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result416.getAt(0);var make_kmi_by_ae = let_result416.getAt(1);var kmi_by_ae_p = let_result416.getAt(2);var kmi_by_ae_ref = let_result416.getAt(3);var kmi_by_ae_set_bang_ = let_result416.getAt(4);var make_required = function(name849, fail_proc850, method_p851, impersonator_p852) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part858 = name849;if (or_part858!==false) {var if_res420 = or_part858;} else {var if_res420 = $rjs_core.Symbol.make("unknown");}if (impersonator_p852!==false) {if (method_p851!==false) {var if_res417 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res417 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res419 = if_res417;} else {if (method_p851!==false) {var if_res418 = struct_keyword_method_by_arity_error;} else {var if_res418 = struct_keyword_procedure_by_arity_error;}var if_res419 = if_res418;}var let_result421 = M0.make_struct_type(if_res420,if_res419,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name849,fail_proc850))),M0.current_inspector(),fail_proc850);var s_853 = let_result421.getAt(0);var mk854 = let_result421.getAt(1);var __p855 = let_result421.getAt(2);var __ref856 = let_result421.getAt(3);var __set_bang_857 = let_result421.getAt(4);return mk854;};var cl422 = function(proc859) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name860 = M0.object_name(proc859);var plain_proc861 = $rjs_core.attachProcedureArity(function(...args862425) {var args862 = $rjs_core.Pair.listFromArray(args862425);return M0.apply(proc859,M0.rnull,M0.rnull,args862);});if (M0.symbol_p(proc_name860)!==false) {var if_res426 = M0.__rjs_quoted__.procedure_rename(plain_proc861,proc_name860);} else {var if_res426 = plain_proc861;}return make_keyword_procedure(proc859,if_res426);};var cl423 = function(proc863, plain_proc864) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc863)!==false) {var if_res427 = M0.procedure_arity_mask(proc863);} else {var if_res427 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res427),proc863,M0.rnull,false,plain_proc864);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam424 = {'1':cl422,'2':cl423}[arguments.length];if (fixed_lam424!==undefined) {return fixed_lam424.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc865, kws866, kw_vals867, normal_args868, ...normal_argss869428) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss869 = $rjs_core.Pair.listFromArray(normal_argss869428);var type_error870 = function(what871, which872) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.Symbol.make("keyword-apply"),what871,which872,proc865,kws866,kw_vals867,normal_args868,normal_argss869);};if (M0.procedure_p(proc865)!==false) {var if_res429 = M0.rvoid();} else {var if_res429 = type_error870($rjs_core.UString.make("procedure?"),0);}if_res429;var loop873 = function(ks874) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks874)!==false) {var if_res436 = M0.rvoid();} else {var or_part875 = M0.not(M0.pair_p(ks874));if (or_part875!==false) {var if_res430 = or_part875;} else {var if_res430 = M0.not(M0.keyword_p(M0.car(ks874)));}if (if_res430!==false) {var if_res435 = type_error870($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks874))!==false) {var if_res434 = M0.rvoid();} else {var or_part876 = M0.not(M0.pair_p(M0.cdr(ks874)));if (or_part876!==false) {var if_res431 = or_part876;} else {var if_res431 = M0.not(M0.keyword_p(M0.cadr(ks874)));}if (if_res431!==false) {var if_res433 = loop873(M0.cdr(ks874));} else {if (M0.keyword_lt__p(M0.car(ks874),M0.cadr(ks874))!==false) {var if_res432 = loop873(M0.cdr(ks874));} else {var if_res432 = type_error870($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res433 = if_res432;}var if_res434 = if_res433;}var if_res435 = if_res434;}var if_res436 = if_res435;}return if_res436;};loop873(kws866);if (M0.list_p(kw_vals867)!==false) {var if_res437 = M0.rvoid();} else {var if_res437 = type_error870($rjs_core.UString.make("list?"),2);}if_res437;if (M0.__eq_(M0.length(kws866),M0.length(kw_vals867))!==false) {var if_res438 = M0.rvoid();} else {var if_res438 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws866),$rjs_core.UString.make("value list length"),M0.length(kw_vals867),$rjs_core.UString.make("keyword list"),kws866,$rjs_core.UString.make("value list"),kw_vals867);}if_res438;var loop878 = function(normal_argss879, pos880) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss879))!==false) {var l881 = M0.car(normal_argss879);if (M0.list_p(l881)!==false) {var if_res439 = l881;} else {var if_res439 = type_error870($rjs_core.UString.make("list?"),pos880);}var if_res440 = if_res439;} else {var if_res440 = M0.cons(M0.car(normal_argss879),loop878(M0.cdr(normal_argss879),M0.add1(pos880)));}return if_res440;};var normal_args877 = loop878(M0.cons(normal_args868,normal_argss869),3);if (M0.null_p(kws866)!==false) {var if_res441 = M0.apply(proc865,normal_args877);} else {var if_res441 = M0.apply(keyword_procedure_extract_by_method(kws866,2+M0.length(normal_args877),proc865,0),kws866,kw_vals867,normal_args877);}return if_res441;});var procedure_keywords = function(p882) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p882)!==false) {var if_res446 = M0.values(keyword_procedure_required(p882),keyword_procedure_allowed(p882));} else {if (M0.procedure_p(p882)!==false) {if (new_procedure_p(p882)!==false) {var v883 = new_procedure_ref(p882);if (M0.procedure_p(v883)!==false) {var if_res443 = procedure_keywords(v883);} else {var a884 = procedure_accessor_ref(p882);if (a884!==false) {var if_res442 = procedure_keywords(a884(p882));} else {var if_res442 = M0.values(M0.rnull,M0.rnull);}var if_res443 = if_res442;}var if_res444 = if_res443;} else {var if_res444 = M0.values(M0.rnull,M0.rnull);}var if_res445 = if_res444;} else {var if_res445 = M0.raise_argument_error($rjs_core.Symbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p882);}var if_res446 = if_res445;}return if_res446;};var missing_kw = $rjs_core.attachProcedureArity(function(proc885, ...args886447) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args886 = $rjs_core.Pair.listFromArray(args886447);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc885,0),M0.rnull,M0.rnull,args886);});var check_kw_args = function(p887, kws888) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop889 = function(kws890, required891, allowed892) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws890)!==false) {if (M0.null_p(required891)!==false) {var if_res448 = M0.values(false,false);} else {var if_res448 = M0.values(M0.car(required891),false);}var if_res457 = if_res448;} else {if (M0.pair_p(required891)!==false) {var if_res449 = M0.eq_p(M0.car(required891),M0.car(kws890));} else {var if_res449 = false;}if (if_res449!==false) {var temp452 = M0.cdr(kws890);var temp451 = M0.cdr(required891);if (allowed892!==false) {var if_res450 = M0.cdr(allowed892);} else {var if_res450 = false;}var if_res456 = loop889(temp452,temp451,if_res450);} else {if (M0.not(allowed892)!==false) {var if_res455 = loop889(M0.cdr(kws890),required891,false);} else {if (M0.pair_p(allowed892)!==false) {if (M0.eq_p(M0.car(allowed892),M0.car(kws890))!==false) {var if_res453 = loop889(M0.cdr(kws890),required891,M0.cdr(allowed892));} else {var if_res453 = loop889(kws890,required891,M0.cdr(allowed892));}var if_res454 = if_res453;} else {var if_res454 = M0.values(false,M0.car(kws890));}var if_res455 = if_res454;}var if_res456 = if_res455;}var if_res457 = if_res456;}return if_res457;};return loop889(kws888,keyword_procedure_required(p887),keyword_procedure_allowed(p887));};var make_keyword_checker = function(req_kws893, allowed_kws894, arity_mask895) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws894)!==false) {if (M0.null_p(req_kws893)!==false) {var if_res460 = function(kws896, a897) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res458 = M0.bitwise_bit_set_p(arity_mask895,a897);} else {var if_res458 = false;}return if_res458;};} else {var if_res460 = function(kws898, a899) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws893,kws898)!==false) {var if_res459 = M0.bitwise_bit_set_p(arity_mask895,a899);} else {var if_res459 = false;}return if_res459;};}var if_res473 = if_res460;} else {if (M0.null_p(allowed_kws894)!==false) {var if_res472 = function(kws900, a901) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws900)!==false) {var if_res461 = M0.bitwise_bit_set_p(arity_mask895,a901);} else {var if_res461 = false;}return if_res461;};} else {if (M0.null_p(req_kws893)!==false) {var if_res471 = function(kws902, a903) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws902,allowed_kws894)!==false) {var if_res462 = M0.bitwise_bit_set_p(arity_mask895,a903);} else {var if_res462 = false;}return if_res462;};} else {if (M0.list_p(req_kws893)!==false) {if (M0.list_p(allowed_kws894)!==false) {var if_res463 = M0.eq_p(M0.length(req_kws893),M0.length(allowed_kws894));} else {var if_res463 = false;}var if_res464 = if_res463;} else {var if_res464 = false;}if (if_res464!==false) {var if_res470 = function(kws904, a905) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop906 = function(kws907, req_kws908) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws908)!==false) {var if_res467 = M0.null_p(kws907);} else {if (M0.null_p(kws907)!==false) {var if_res466 = false;} else {if (M0.eq_p(M0.car(kws907),M0.car(req_kws908))!==false) {var if_res465 = loop906(M0.cdr(kws907),M0.cdr(req_kws908));} else {var if_res465 = false;}var if_res466 = if_res465;}var if_res467 = if_res466;}return if_res467;};if (loop906(kws904,req_kws893)!==false) {var if_res468 = M0.bitwise_bit_set_p(arity_mask895,a905);} else {var if_res468 = false;}return if_res468;};} else {var if_res470 = function(kws909, a910) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws893,kws909,allowed_kws894)!==false) {var if_res469 = M0.bitwise_bit_set_p(arity_mask895,a910);} else {var if_res469 = false;}return if_res469;};}var if_res471 = if_res470;}var if_res472 = if_res471;}var if_res473 = if_res472;}return if_res473;};var subset_p = function(l1911, l2912) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1911)!==false) {var if_res476 = true;} else {if (M0.null_p(l2912)!==false) {var if_res475 = false;} else {if (M0.eq_p(M0.car(l1911),M0.car(l2912))!==false) {var if_res474 = subset_p(M0.cdr(l1911),M0.cdr(l2912));} else {var if_res474 = subset_p(l1911,M0.cdr(l2912));}var if_res475 = if_res474;}var if_res476 = if_res475;}return if_res476;};var subsets_p = function(l1913, l2914, l3915) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1913)!==false) {var if_res481 = subset_p(l2914,l3915);} else {if (M0.null_p(l2914)!==false) {var if_res480 = false;} else {if (M0.null_p(l3915)!==false) {var if_res479 = false;} else {var v2916 = M0.car(l2914);if (M0.eq_p(M0.car(l1913),v2916)!==false) {var if_res478 = subsets_p(M0.cdr(l1913),M0.cdr(l2914),M0.cdr(l3915));} else {if (M0.eq_p(v2916,M0.car(l3915))!==false) {var if_res477 = subsets_p(l1913,M0.cdr(l2914),M0.cdr(l3915));} else {var if_res477 = subsets_p(l1913,l2914,M0.cdr(l3915));}var if_res478 = if_res477;}var if_res479 = if_res478;}var if_res480 = if_res479;}var if_res481 = if_res480;}return if_res481;};var keyword_procedure_extract_by_method = function(kws917, n918, p919, method_n920) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p919)!==false) {var if_res482 = keyword_procedure_checker(p919)(kws917,n918);} else {var if_res482 = false;}if (if_res482!==false) {var if_res512 = keyword_procedure_proc(p919);} else {if (M0.not(keyword_procedure_p(p919))!==false) {if (M0.procedure_p(p919)!==false) {if (new_procedure_p(p919)!==false) {var a923 = procedure_accessor_ref(p919);if (a923!==false) {var if_res483 = a923(p919);} else {var if_res483 = false;}var if_res484 = if_res483;} else {var if_res484 = false;}var or_part922 = if_res484;if (or_part922!==false) {var if_res487 = or_part922;} else {var or_part924 = M0.procedure_extract_target(p919);if (or_part924!==false) {var if_res486 = or_part924;} else {if (new_procedure_p(p919)!==false) {var if_res485 = $rjs_core.Symbol.make("method");} else {var if_res485 = false;}var if_res486 = if_res485;}var if_res487 = if_res486;}var if_res488 = if_res487;} else {var if_res488 = false;}var if_res489 = if_res488;} else {var if_res489 = false;}var p2921 = if_res489;if (p2921!==false) {if (M0.eq_p(p2921,$rjs_core.Symbol.make("method"))!==false) {var p3925 = keyword_procedure_extract_by_method(kws917,M0.add1(n918),new_procedure_ref(p919),M0.add1(method_n920));var if_res491 = $rjs_core.attachProcedureArity(function(kws926, kw_args927, ...args928490) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args928 = $rjs_core.Pair.listFromArray(args928490);return M0.apply(p3925,kws926,kw_args927,M0.cons(p919,args928));});} else {var if_res491 = keyword_procedure_extract_by_method(kws917,n918,p2921,method_n920);}var if_res511 = if_res491;} else {var if_res511 = $rjs_core.attachProcedureArity(function(kws929, kw_args930, ...args931492) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args931 = $rjs_core.Pair.listFromArray(args931492);if (keyword_procedure_p(p919)!==false) {var if_res493 = check_kw_args(p919,kws929);} else {var if_res493 = M0.values(false,M0.car(kws929));}var let_result494 = if_res493;var missing_kw932 = let_result494.getAt(0);var extra_kw933 = let_result494.getAt(1);var or_part938 = keyword_method_p(p919);if (or_part938!==false) {var if_res495 = or_part938;} else {var if_res495 = okm_p(p919);}if (if_res495!==false) {var if_res496 = 1;} else {var if_res496 = 0;}var method_n937 = method_n920+if_res496;if (M0.__gt__eq_(n918,method_n937)!==false) {var if_res497 = n918-method_n937;} else {var if_res497 = n918;}var n934 = if_res497;if (M0.null_p(args931)!==false) {var if_res498 = M0.null_p(kws929);} else {var if_res498 = false;}if (if_res498!==false) {var if_res499 = $rjs_core.UString.make("");} else {var if_res499 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v939) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v939);},args931),M0.map(function(kw940, kw_arg941) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw940,kw_arg941);},kws929,kw_args930)));}var args_str935 = if_res499;var proc_name936 = function(p942) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p942)!==false) {var if_res500 = M0.car(keyword_procedure_name_plus_fail(p942));} else {var if_res500 = false;}var or_part943 = if_res500;if (or_part943!==false) {var if_res502 = or_part943;} else {var or_part944 = M0.object_name(p942);if (or_part944!==false) {var if_res501 = or_part944;} else {var if_res501 = p942;}var if_res502 = if_res501;}return if_res502;};var or_part945 = extra_kw933;if (or_part945!==false) {var if_res509 = or_part945;} else {var if_res509 = missing_kw932;}if (if_res509!==false) {var if_res510 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res510 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw933!==false) {if (keyword_procedure_p(p919)!==false) {var if_res504 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name936(p919),extra_kw933,args_str935);} else {if (M0.procedure_p(p919)!==false) {var if_res503 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name936(p919),args_str935);} else {var if_res503 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p919,args_str935);}var if_res504 = if_res503;}var if_res508 = if_res504;} else {if (missing_kw932!==false) {var if_res507 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name936(p919),missing_kw932,args_str935);} else {var temp506 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n934-2)!==false) {var if_res505 = $rjs_core.UString.make("");} else {var if_res505 = $rjs_core.UString.make("s");}var if_res507 = M0.format(temp506,n934-2,if_res505,proc_name936(p919),args_str935);}var if_res508 = if_res507;}return M0.raise(if_res510(if_res508,M0.current_continuation_marks()));});}var if_res512 = if_res511;}return if_res512;};var keyword_procedure_extract = function(p946, kws947, n948) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws947,n948,p946,0);};var cl513 = function(proc949, arity950, req_kw951, allowed_kw952, name953) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity"),proc949,arity950,false,name953,req_kw951,allowed_kw952);};var cl514 = function(proc954, arity955, req_kw956, allowed_kw957) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity"),proc954,arity955,false,false,req_kw956,allowed_kw957);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam515 = {'5':cl513,'4':cl514}[arguments.length];if (fixed_lam515!==undefined) {return fixed_lam515.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl516 = function(proc958, mask959, req_kw960, allowed_kw961, name962) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity-mask"),proc958,false,mask959,name962,req_kw960,allowed_kw961);};var cl517 = function(proc963, mask964, req_kw965, allowed_kw966) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity-mask"),proc963,false,mask964,false,req_kw965,allowed_kw966);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam518 = {'5':cl516,'4':cl517}[arguments.length];if (fixed_lam518!==undefined) {return fixed_lam518.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who967, proc968, arity969, mask970, name971, req_kw972, allowed_kw973) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc968)!==false) {var if_res519 = okp_ref(proc968,0);} else {var if_res519 = proc968;}var p975 = if_res519;if (arity969!==false) {var if_res520 = M0.__rjs_quoted__.procedure_reduce_arity(p975,arity969);} else {var if_res520 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p975,mask970,name971);}var plain_proc974 = if_res520;var sorted_p976 = function(kws977) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop978 = function(kws979) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws979)!==false) {var if_res523 = true;} else {if (M0.null_p(M0.cdr(kws979))!==false) {var if_res522 = true;} else {if (M0.keyword_lt__p(M0.car(kws979),M0.cadr(kws979))!==false) {var if_res521 = loop978(M0.cdr(kws979));} else {var if_res521 = false;}var if_res522 = if_res521;}var if_res523 = if_res522;}return if_res523;};return loop978(kws977);};if (M0.list_p(req_kw972)!==false) {if (M0.andmap(M0.keyword_p,req_kw972)!==false) {var if_res524 = sorted_p976(req_kw972);} else {var if_res524 = false;}var if_res525 = if_res524;} else {var if_res525 = false;}if (if_res525!==false) {var if_res528 = M0.rvoid();} else {var temp527 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part980 = arity969;if (or_part980!==false) {var if_res526 = or_part980;} else {var if_res526 = mask970;}var if_res528 = M0.raise_argument_error(who967,temp527,2,proc968,if_res526,req_kw972,allowed_kw973);}if_res528;if (allowed_kw973!==false) {if (M0.list_p(allowed_kw973)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw973)!==false) {var if_res529 = sorted_p976(allowed_kw973);} else {var if_res529 = false;}var if_res530 = if_res529;} else {var if_res530 = false;}if (if_res530!==false) {var if_res533 = M0.rvoid();} else {var temp532 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part981 = arity969;if (or_part981!==false) {var if_res531 = or_part981;} else {var if_res531 = mask970;}var if_res533 = M0.raise_argument_error(who967,temp532,3,proc968,if_res531,req_kw972,allowed_kw973);}if_res533;if (subset_p(req_kw972,allowed_kw973)!==false) {var if_res534 = M0.rvoid();} else {var if_res534 = M0.raise_arguments_error(who967,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw973,$rjs_core.UString.make("required keywords"),req_kw972);}var if_res535 = if_res534;} else {var if_res535 = M0.rvoid();}if_res535;var let_result536 = procedure_keywords(proc968);var old_req982 = let_result536.getAt(0);var old_allowed983 = let_result536.getAt(1);if (subset_p(old_req982,req_kw972)!==false) {var if_res537 = M0.rvoid();} else {var if_res537 = M0.raise_arguments_error(who967,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req982,$rjs_core.UString.make("requested required keywords"),req_kw972);}if_res537;if (old_allowed983!==false) {if (subset_p(req_kw972,old_allowed983)!==false) {var if_res538 = M0.rvoid();} else {var if_res538 = M0.raise_arguments_error(who967,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed983,$rjs_core.UString.make("requested required keywords"),req_kw972);}if_res538;var or_part984 = M0.not(allowed_kw973);if (or_part984!==false) {var if_res539 = or_part984;} else {var if_res539 = subset_p(allowed_kw973,old_allowed983);}if (if_res539!==false) {var if_res540 = M0.rvoid();} else {var if_res540 = M0.raise_arguments_error(who967,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed983,$rjs_core.UString.make("requested allowed keywords"),allowed_kw973);}var if_res541 = if_res540;} else {var if_res541 = M0.rvoid();}if_res541;if (M0.null_p(allowed_kw973)!==false) {var if_res549 = plain_proc974;} else {var or_part986 = mask970;if (or_part986!==false) {var if_res542 = or_part986;} else {var if_res542 = arity__gt_mask(arity969);}var mask985 = if_res542;var new_mask987 = M0.arithmetic_shift(mask985,2);var kw_checker988 = make_keyword_checker(req_kw972,allowed_kw973,new_mask987);var proc989 = normalize_proc(proc968);var new_kw_proc990 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc989),new_mask987);if (M0.null_p(req_kw972)!==false) {if (okm_p(proc989)!==false) {var if_res543 = make_optional_keyword_method;} else {var if_res543 = make_optional_keyword_procedure;}var if_res548 = if_res543(kw_checker988,new_kw_proc990,req_kw972,allowed_kw973,plain_proc974);} else {if (named_keyword_procedure_p(proc989)!==false) {var if_res546 = M0.car(keyword_procedure_name_plus_fail(proc989));} else {var if_res546 = false;}var or_part991 = if_res546;if (or_part991!==false) {var if_res547 = or_part991;} else {var if_res547 = M0.object_name(proc989);}var temp545 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask985,1));var or_part992 = okm_p(proc989);if (or_part992!==false) {var if_res544 = or_part992;} else {var if_res544 = keyword_method_p(proc989);}var if_res548 = make_required(if_res547,temp545,if_res544,false)(kw_checker988,new_kw_proc990,req_kw972,allowed_kw973);}var if_res549 = if_res548;}return if_res549;};var arity__gt_mask = function(a993) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a993)!==false) {var if_res555 = M0.arithmetic_shift(1,a993);} else {if (M0.arity_at_least_p(a993)!==false) {var if_res554 = M0.__rjs_quoted__.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a993))));} else {if (M0.list_p(a993)!==false) {var loop994 = function(mask995, l996) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l996)!==false) {var if_res552 = mask995;} else {var a997 = M0.car(l996);var or_part998 = M0.exact_nonnegative_integer_p(a997);if (or_part998!==false) {var if_res550 = or_part998;} else {var if_res550 = M0.arity_at_least_p(a997);}if (if_res550!==false) {var if_res551 = loop994(M0.__rjs_quoted__.bitwise_ior(mask995,arity__gt_mask(a997)),M0.cdr(l996));} else {var if_res551 = false;}var if_res552 = if_res551;}return if_res552;};var if_res553 = loop994(0,a993);} else {var if_res553 = false;}var if_res554 = if_res553;}var if_res555 = if_res554;}return if_res555;};var cl556 = function(proc1000, arity1001, name1002) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1000)!==false) {var let_result559 = procedure_keywords(proc1000);var req1003 = let_result559.getAt(0);var allows1004 = let_result559.getAt(1);if (M0.pair_p(req1003)!==false) {var if_res560 = M0.not(M0.null_p(arity1001));} else {var if_res560 = false;}var if_res561 = if_res560;} else {var if_res561 = false;}if (if_res561!==false) {var if_res563 = M0.raise_arguments_error($rjs_core.Symbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1000);} else {if (okm_p(proc1000)!==false) {var if_res562 = M0.__rjs_quoted__.procedure__gt_method(proc1000);} else {var if_res562 = proc1000;}var if_res563 = M0.__rjs_quoted__.procedure_reduce_arity(if_res562,arity1001,name1002);}return if_res563;};var cl557 = function(proc1005, arity1006) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc1005,arity1006,false);};var procedure_reduce_arity999 = $rjs_core.attachProcedureArity(function() {var fixed_lam558 = {'3':cl556,'2':cl557}[arguments.length];if (fixed_lam558!==undefined) {return fixed_lam558.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity999;var cl564 = function(proc1008, mask1009, name1010) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc1008)!==false) {var let_result567 = procedure_keywords(proc1008);var req1011 = let_result567.getAt(0);var allows1012 = let_result567.getAt(1);if (M0.pair_p(req1011)!==false) {var if_res568 = M0.not(M0.eqv_p(mask1009,0));} else {var if_res568 = false;}var if_res569 = if_res568;} else {var if_res569 = false;}if (if_res569!==false) {var if_res571 = M0.raise_arguments_error($rjs_core.Symbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1008);} else {if (okm_p(proc1008)!==false) {var if_res570 = M0.__rjs_quoted__.procedure__gt_method(proc1008);} else {var if_res570 = proc1008;}var if_res571 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res570,mask1009,name1010);}return if_res571;};var cl565 = function(proc1013, mask1014) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc1013,mask1014,false);};var procedure_reduce_arity1007 = $rjs_core.attachProcedureArity(function() {var fixed_lam566 = {'3':cl564,'2':cl565}[arguments.length];if (fixed_lam566!==undefined) {return fixed_lam566.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1007;var procedure__gt_method1015 = function(proc1016) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc1017 = normalize_proc(proc1016);if (keyword_procedure_p(proc1017)!==false) {if (okm_p(proc1017)!==false) {var if_res574 = proc1017;} else {if (keyword_method_p(proc1017)!==false) {var if_res573 = proc1017;} else {if (okp_p(proc1017)!==false) {var if_res572 = make_optional_keyword_method(keyword_procedure_checker(proc1017),keyword_procedure_proc(proc1017),keyword_procedure_required(proc1017),keyword_procedure_allowed(proc1017),okp_ref(proc1017,0));} else {var name_plus_fail1018 = keyword_procedure_name_plus_fail(proc1017);var mk1019 = make_required(M0.car(name_plus_fail1018),M0.cdr(name_plus_fail1018),true,false);var if_res572 = mk1019(keyword_procedure_checker(proc1017),keyword_procedure_proc(proc1017),keyword_procedure_required(proc1017),keyword_procedure_allowed(proc1017));}var if_res573 = if_res572;}var if_res574 = if_res573;}var if_res575 = if_res574;} else {var if_res575 = M0.__rjs_quoted__.procedure__gt_method(proc1017);}return if_res575;};var new_procedure__gt_method = procedure__gt_method1015;var procedure_rename1020 = function(proc1021, name1022) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1021)!==false) {var if_res576 = M0.symbol_p(name1022);} else {var if_res576 = false;}if (M0.not(if_res576)!==false) {var if_res579 = M0.__rjs_quoted__.procedure_rename(proc1021,name1022);} else {if (okp_p(proc1021)!==false) {if (okm_p(proc1021)!==false) {var if_res577 = make_optional_keyword_method;} else {var if_res577 = make_optional_keyword_procedure;}var if_res578 = if_res577(keyword_procedure_checker(proc1021),keyword_procedure_proc(proc1021),keyword_procedure_required(proc1021),keyword_procedure_allowed(proc1021),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1021,0),name1022));} else {var name_plus_fail1023 = keyword_procedure_name_plus_fail(proc1021);var mk1024 = make_required(name1022,M0.cdr(name_plus_fail1023),keyword_method_p(proc1021),false);var if_res578 = mk1024(keyword_procedure_checker(proc1021),keyword_procedure_proc(proc1021),keyword_procedure_required(proc1021),keyword_procedure_allowed(proc1021));}var if_res579 = if_res578;}return if_res579;};var new_procedure_rename = procedure_rename1020;var chaperone_procedure1025 = $rjs_core.attachProcedureArity(function(proc1026, wrap_proc1027, ...props1028580) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1028 = $rjs_core.Pair.listFromArray(props1028580);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.Symbol.make("chaperone-procedure"),proc1026,wrap_proc1027,props1028);});var new_chaperone_procedure = chaperone_procedure1025;var unsafe_chaperone_procedure1029 = $rjs_core.attachProcedureArity(function(proc1030, wrap_proc1031, ...props1032581) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1032 = $rjs_core.Pair.listFromArray(props1032581);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.Symbol.make("unsafe-chaperone-procedure"),proc1030,wrap_proc1031,props1032);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1029;var impersonate_procedure1033 = $rjs_core.attachProcedureArity(function(proc1034, wrap_proc1035, ...props1036582) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1036 = $rjs_core.Pair.listFromArray(props1036582);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.Symbol.make("impersonate-procedure"),proc1034,wrap_proc1035,props1036);});var new_impersonate_procedure = impersonate_procedure1033;var unsafe_impersonate_procedure1037 = $rjs_core.attachProcedureArity(function(proc1038, wrap_proc1039, ...props1040583) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1040 = $rjs_core.Pair.listFromArray(props1040583);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.Symbol.make("unsafe-impersonate-procedure"),proc1038,wrap_proc1039,props1040);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1037;var chaperone_procedure_times_1041 = $rjs_core.attachProcedureArity(function(proc1042, wrap_proc1043, ...props1044584) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1044 = $rjs_core.Pair.listFromArray(props1044584);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.Symbol.make("chaperone-procedure"),proc1042,wrap_proc1043,props1044);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1041;var impersonate_procedure_times_1045 = $rjs_core.attachProcedureArity(function(proc1046, wrap_proc1047, ...props1048585) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1048 = $rjs_core.Pair.listFromArray(props1048585);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.Symbol.make("impersonate-procedure"),proc1046,wrap_proc1047,props1048);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1045;var do_chaperone_procedure = function(is_impersonator_p1049, self_arg_p1050, chaperone_procedure1051, name1052, proc1053, wrap_proc1054, props1055) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1056 = normalize_proc(proc1053);var n_wrap_proc1057 = normalize_proc(wrap_proc1054);var or_part1058 = M0.not(keyword_procedure_p(n_proc1056));if (or_part1058!==false) {var if_res587 = or_part1058;} else {var or_part1059 = M0.not(M0.procedure_p(wrap_proc1054));if (or_part1059!==false) {var if_res586 = or_part1059;} else {var if_res586 = bad_props_p(props1055);}var if_res587 = if_res586;}if (if_res587!==false) {var if_res651 = M0.apply(chaperone_procedure1051,proc1053,wrap_proc1054,props1055);} else {chaperone_arity_match_checking(self_arg_p1050,name1052,proc1053,wrap_proc1054,props1055);var p1061 = keyword_procedure_proc(n_wrap_proc1057);if (self_arg_p1050!==false) {var cl588 = $rjs_core.attachProcedureArity(function(self_proc1062, kws1063, args1064, ...rest1065593) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1065 = $rjs_core.Pair.listFromArray(rest1065593);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1061,kws1063,args1064,self_proc1062,rest1065);},$rjs_core.attachProcedureArity(function(...results1066594) {var results1066 = $rjs_core.Pair.listFromArray(results1066594);var len1067 = M0.length(results1066);var alen1068 = M0.length(rest1065);if (M0.__lt_(len1067,alen1068+1)!==false) {var if_res595 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1068+1,$rjs_core.UString.make("received number of results"),len1067,$rjs_core.UString.make("wrapper procedure"),wrap_proc1054);} else {var if_res595 = M0.rvoid();}if_res595;var num_extra1069 = len1067-(alen1068+1);var new_args1070 = M0.list_ref(results1066,num_extra1069);if (M0.list_p(new_args1070)!==false) {var if_res596 = M0.__eq_(M0.length(new_args1070),M0.length(args1064));} else {var if_res596 = false;}if (if_res596!==false) {var if_res600 = M0.rvoid();} else {var temp599 = $rjs_core.Symbol.make("keyword procedure chaperone");var temp598 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1067,alen1068)!==false) {var if_res597 = $rjs_core.UString.make("");} else {var if_res597 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res600 = M0.raise_arguments_error(temp599,M0.format(temp598,if_res597),$rjs_core.UString.make("first result"),new_args1070,$rjs_core.UString.make("wrapper procedure"),wrap_proc1054);}if_res600;M0.for_each(function(kw1071, new_arg1072, arg1073) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1049!==false) {var if_res602 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1072,arg1073)!==false) {var if_res601 = M0.rvoid();} else {var if_res601 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1071),$rjs_core.UString.make("result"),new_arg1072,$rjs_core.UString.make("wrapper procedure"),wrap_proc1054);}var if_res602 = if_res601;}return if_res602;},kws1063,new_args1070,args1064);var tmp1074 = num_extra1069;if (M0.equal_p(tmp1074,0)!==false) {var if_res605 = M0.apply(M0.values,kws1063,results1066);} else {if (M0.equal_p(tmp1074,1)!==false) {var if_res604 = M0.apply(M0.values,M0.car(results1066),kws1063,M0.cdr(results1066));} else {var loop1075 = function(results1076, c1077) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1077)!==false) {var if_res603 = M0.cons(kws1063,results1076);} else {var if_res603 = M0.cons(M0.car(results1076),loop1075(M0.cdr(results1076),M0.sub1(c1077)));}return if_res603;};var if_res604 = M0.apply(M0.values,loop1075(results1066,num_extra1069));}var if_res605 = if_res604;}return if_res605;}));});var cl589 = $rjs_core.attachProcedureArity(function(...other1078606) {var other1078 = $rjs_core.Pair.listFromArray(other1078606);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res626 = $rjs_core.attachProcedureArity(function() {var fixed_lam590 = {}[arguments.length];if (fixed_lam590!==undefined) {return fixed_lam590.apply(null,arguments);} else {if (M0.__gt__eq_(cl588.length,1)!==false) {var if_res592 = cl588.apply(null,arguments);} else {if (true!==false) {var if_res591 = cl589.apply(null,arguments);} else {var if_res591 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res592 = if_res591;}return if_res592;}},[M0.make_arity_at_least(0)]);} else {var cl607 = $rjs_core.attachProcedureArity(function(kws1079, args1080, ...rest1081612) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1081 = $rjs_core.Pair.listFromArray(rest1081612);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1061,kws1079,args1080,rest1081);},$rjs_core.attachProcedureArity(function(...results1082613) {var results1082 = $rjs_core.Pair.listFromArray(results1082613);var len1083 = M0.length(results1082);var alen1084 = M0.length(rest1081);if (M0.__lt_(len1083,alen1084+1)!==false) {var if_res614 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1084+1,$rjs_core.UString.make("received number of results"),len1083,$rjs_core.UString.make("wrapper procedure"),wrap_proc1054);} else {var if_res614 = M0.rvoid();}if_res614;var num_extra1085 = len1083-(alen1084+1);var new_args1086 = M0.list_ref(results1082,num_extra1085);if (M0.list_p(new_args1086)!==false) {var if_res615 = M0.__eq_(M0.length(new_args1086),M0.length(args1080));} else {var if_res615 = false;}if (if_res615!==false) {var if_res619 = M0.rvoid();} else {var temp618 = $rjs_core.Symbol.make("keyword procedure chaperone");var temp617 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1083,alen1084)!==false) {var if_res616 = $rjs_core.UString.make("");} else {var if_res616 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res619 = M0.raise_arguments_error(temp618,M0.format(temp617,if_res616),$rjs_core.UString.make("first result"),new_args1086,$rjs_core.UString.make("wrapper procedure"),wrap_proc1054);}if_res619;M0.for_each(function(kw1087, new_arg1088, arg1089) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1049!==false) {var if_res621 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1088,arg1089)!==false) {var if_res620 = M0.rvoid();} else {var if_res620 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1087),$rjs_core.UString.make("result"),new_arg1088,$rjs_core.UString.make("wrapper procedure"),wrap_proc1054);}var if_res621 = if_res620;}return if_res621;},kws1079,new_args1086,args1080);var tmp1090 = num_extra1085;if (M0.equal_p(tmp1090,0)!==false) {var if_res624 = M0.apply(M0.values,kws1079,results1082);} else {if (M0.equal_p(tmp1090,1)!==false) {var if_res623 = M0.apply(M0.values,M0.car(results1082),kws1079,M0.cdr(results1082));} else {var loop1091 = function(results1092, c1093) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1093)!==false) {var if_res622 = M0.cons(kws1079,results1092);} else {var if_res622 = M0.cons(M0.car(results1092),loop1091(M0.cdr(results1092),M0.sub1(c1093)));}return if_res622;};var if_res623 = M0.apply(M0.values,loop1091(results1082,num_extra1085));}var if_res624 = if_res623;}return if_res624;}));});var cl608 = $rjs_core.attachProcedureArity(function(...other1094625) {var other1094 = $rjs_core.Pair.listFromArray(other1094625);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res626 = $rjs_core.attachProcedureArity(function() {var fixed_lam609 = {}[arguments.length];if (fixed_lam609!==undefined) {return fixed_lam609.apply(null,arguments);} else {if (M0.__gt__eq_(cl607.length,1)!==false) {var if_res611 = cl607.apply(null,arguments);} else {if (true!==false) {var if_res610 = cl608.apply(null,arguments);} else {var if_res610 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res611 = if_res610;}return if_res611;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1060 = if_res626;var wrap1097 = function(proc1098, n_proc1099) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1099,proc1098))!==false) {var if_res627 = new_procedure_p(proc1098);} else {var if_res627 = false;}if (if_res627!==false) {var v1100 = new_procedure_ref(proc1098);if (M0.exact_integer_p(v1100)!==false) {var acc1101 = procedure_accessor_ref(proc1098);var if_res643 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1098,acc1101,function(self1102, sub_proc1103) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result628 = wrap1097(sub_proc1103,normalize_proc(sub_proc1103));var f1104 = let_result628.getAt(0);var acc1105 = let_result628.getAt(1);return f1104;}),acc1101);} else {if (is_impersonator_p1049!==false) {var if_res642 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res642 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1099)!==false) {var if_res641 = chaperone_procedure1051(proc1098,wrap_proc1054);} else {var if_res641 = proc1098;}var new_kw_proc1106 = if_res642(if_res641,new_procedure_ref,function(self1107, proc1108) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1049!==false) {var if_res640 = new_impersonate_procedure;} else {var if_res640 = new_chaperone_procedure;}if (self_arg_p1050!==false) {var if_res639 = $rjs_core.attachProcedureArity(function(proc_self1109, kws1110, kw_args1111, self1112, ...args1113629) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1113 = $rjs_core.Pair.listFromArray(args1113629);var len1114 = M0.length(args1113);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1060,proc_self1109,kws1110,kw_args1111,args1113);},$rjs_core.attachProcedureArity(function(...results1115630) {var results1115 = $rjs_core.Pair.listFromArray(results1115630);var r_len1116 = M0.length(results1115);var list_take1117 = function(l1118, n1119) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1119)!==false) {var if_res631 = M0.rnull;} else {var if_res631 = M0.cons(M0.car(l1118),list_take1117(M0.cdr(l1118),M0.sub1(n1119)));}return if_res631;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.Symbol.make("proc-self")))!==false) {var if_res632 = M0.__eq_(r_len1116,2+len1114);} else {var if_res632 = false;}if (if_res632!==false) {var if_res633 = M0.apply(M0.values,M0.cadr(results1115),self1112,M0.cddr(results1115));} else {var skip1120 = r_len1116-len1114;var if_res633 = M0.apply(M0.values,M0.append(list_take1117(results1115,skip1120-2),M0.list(M0.list_ref(results1115,M0.sub1(skip1120)),self1112),M0.__rjs_quoted__.list_tail(results1115,skip1120)));}return if_res633;}));});} else {var if_res639 = $rjs_core.attachProcedureArity(function(kws1121, kw_args1122, self1123, ...args1124634) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1124 = $rjs_core.Pair.listFromArray(args1124634);var len1125 = M0.length(args1124);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1060,kws1121,kw_args1122,args1124);},$rjs_core.attachProcedureArity(function(...results1126635) {var results1126 = $rjs_core.Pair.listFromArray(results1126635);var r_len1127 = M0.length(results1126);var list_take1128 = function(l1129, n1130) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1130)!==false) {var if_res636 = M0.rnull;} else {var if_res636 = M0.cons(M0.car(l1129),list_take1128(M0.cdr(l1129),M0.sub1(n1130)));}return if_res636;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res637 = M0.__eq_(r_len1127,2+len1125);} else {var if_res637 = false;}if (if_res637!==false) {var if_res638 = M0.apply(M0.values,M0.cadr(results1126),self1123,M0.cddr(results1126));} else {var skip1131 = r_len1127-len1125;var if_res638 = M0.apply(M0.values,M0.append(list_take1128(results1126,skip1131-2),M0.list(M0.list_ref(results1126,M0.sub1(skip1131)),self1123),M0.__rjs_quoted__.list_tail(results1126,skip1131)));}return if_res638;}));});}return if_res640(proc1108,make_keyword_procedure(if_res639));});var if_res643 = M0.values(new_kw_proc1106,new_procedure_ref);}var if_res648 = if_res643;} else {if (okp_p(n_proc1099)!==false) {if (is_impersonator_p1049!==false) {if (okm_p(n_proc1099)!==false) {var if_res644 = make_optional_keyword_method_impersonator;} else {var if_res644 = make_optional_keyword_procedure_impersonator;}var if_res645 = if_res644(keyword_procedure_checker(n_proc1099),chaperone_procedure1051(keyword_procedure_proc(n_proc1099),kw_chaperone1060),keyword_procedure_required(n_proc1099),keyword_procedure_allowed(n_proc1099),chaperone_procedure1051(okp_ref(n_proc1099,0),okp_ref(n_wrap_proc1057,0)),n_proc1099);} else {var if_res645 = M0.__rjs_quoted__.chaperone_struct(proc1098,keyword_procedure_proc,function(self1132, proc1133) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1051(proc1133,kw_chaperone1060);},M0.make_struct_field_accessor(okp_ref,0),function(self1134, proc1135) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1051(proc1135,okp_ref(n_wrap_proc1057,0));});}var if_res647 = M0.values(if_res645,keyword_procedure_proc);} else {if (is_impersonator_p1049!==false) {var name_plus_fail1136 = keyword_procedure_name_plus_fail(n_proc1099);var mk1137 = make_required(M0.car(name_plus_fail1136),M0.cdr(name_plus_fail1136),keyword_method_p(n_proc1099),true);var if_res646 = mk1137(keyword_procedure_checker(n_proc1099),chaperone_procedure1051(keyword_procedure_proc(n_proc1099),kw_chaperone1060),keyword_procedure_required(n_proc1099),keyword_procedure_allowed(n_proc1099),n_proc1099);} else {var if_res646 = M0.__rjs_quoted__.chaperone_struct(n_proc1099,keyword_procedure_proc,function(self1138, proc1139) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1051(proc1139,kw_chaperone1060);});}var if_res647 = M0.values(if_res646,keyword_procedure_proc);}var if_res648 = if_res647;}return if_res648;};var let_result649 = wrap1097(proc1053,n_proc1056);var new_proc1095 = let_result649.getAt(0);var chap_accessor1096 = let_result649.getAt(1);if (M0.null_p(props1055)!==false) {var if_res650 = new_proc1095;} else {var if_res650 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1095,chap_accessor1096,false,props1055);}var if_res651 = if_res650;}return if_res651;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1140, name1141, proc1142, wrap_proc1143, props1144) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1145 = normalize_proc(proc1142);var n_wrap_proc1146 = normalize_proc(wrap_proc1143);var or_part1147 = M0.not(keyword_procedure_p(n_proc1145));if (or_part1147!==false) {var if_res653 = or_part1147;} else {var or_part1148 = M0.not(M0.procedure_p(wrap_proc1143));if (or_part1148!==false) {var if_res652 = or_part1148;} else {var if_res652 = bad_props_p(props1144);}var if_res653 = if_res652;}if (if_res653!==false) {var if_res654 = M0.apply(unsafe_chaperone_procedure1140,proc1142,wrap_proc1143,props1144);} else {chaperone_arity_match_checking(false,name1141,proc1142,wrap_proc1143,props1144);var if_res654 = M0.apply(unsafe_chaperone_procedure1140,proc1142,wrap_proc1143,props1144);}return if_res654;};var bad_props_p = function(props1149) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1150 = function(props1151) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1151)!==false) {var if_res657 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1151))!==false) {var props1152 = M0.cdr(props1151);var or_part1153 = M0.null_p(props1152);if (or_part1153!==false) {var if_res655 = or_part1153;} else {var if_res655 = loop1150(M0.cdr(props1152));}var if_res656 = if_res655;} else {var if_res656 = true;}var if_res657 = if_res656;}return if_res657;};return loop1150(props1149);};var chaperone_arity_match_checking = function(self_arg_p1154, name1155, proc1156, wrap_proc1157, props1158) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1159 = M0.procedure_arity(proc1156);var b1160 = M0.procedure_arity(wrap_proc1157);if (self_arg_p1154!==false) {var if_res658 = 1;} else {var if_res658 = 0;}var d1161 = if_res658;var let_result659 = procedure_keywords(proc1156);var a_req1162 = let_result659.getAt(0);var a_allow1163 = let_result659.getAt(1);var let_result660 = procedure_keywords(wrap_proc1157);var b_req1164 = let_result660.getAt(0);var b_allow1165 = let_result660.getAt(1);var includes_p1166 = function(a1167, b1168) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1168)!==false) {if (M0.number_p(a1167)!==false) {var if_res662 = M0.__eq_(b1168,a1167+d1161);} else {if (M0.arity_at_least_p(a1167)!==false) {var if_res661 = M0.__gt__eq_(b1168,M0.arity_at_least_value(a1167)+d1161);} else {var if_res661 = M0.ormap(function(a1169) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1166(a1169,b1168);},a1167);}var if_res662 = if_res661;}var if_res666 = if_res662;} else {if (M0.arity_at_least_p(b1168)!==false) {if (M0.number_p(a1167)!==false) {var if_res664 = false;} else {if (M0.arity_at_least_p(a1167)!==false) {var if_res663 = M0.__gt__eq_(M0.arity_at_least_value(b1168),M0.arity_at_least_value(a1167)+d1161);} else {var if_res663 = M0.ormap(function(a1170) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1166(b1168,a1170);},a1167);}var if_res664 = if_res663;}var if_res665 = if_res664;} else {var if_res665 = M0.andmap(function(b1171) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1166(a1167,b1171);},b1168);}var if_res666 = if_res665;}return if_res666;};if (includes_p1166(b1160,a1159)!==false) {var if_res667 = M0.rvoid();} else {var if_res667 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1156,wrap_proc1157,props1158);}if_res667;if (subset_p(b_req1164,a_req1162)!==false) {var if_res668 = M0.rvoid();} else {var if_res668 = M0.raise_arguments_error(name1155,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1157,$rjs_core.UString.make("original procedure"),proc1156);}if_res668;var or_part1172 = M0.not(b_allow1165);if (or_part1172!==false) {var if_res670 = or_part1172;} else {if (a_allow1163!==false) {var if_res669 = subset_p(a_allow1163,b_allow1165);} else {var if_res669 = false;}var if_res670 = if_res669;}if (if_res670!==false) {var if_res671 = M0.rvoid();} else {var if_res671 = M0.raise_arguments_error(name1155,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1157,$rjs_core.UString.make("original procedure"),proc1156);}if_res671;return M0.rvoid();};var normalize_proc = function(proc1173) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1173)!==false) {var if_res679 = proc1173;} else {if (new_procedure_p(proc1173)!==false) {var let_result672 = procedure_keywords(proc1173);var req_kws1174 = let_result672.getAt(0);var allowed_kws1175 = let_result672.getAt(1);if (M0.null_p(allowed_kws1175)!==false) {var if_res677 = proc1173;} else {var if_res677 = make_optional_keyword_procedure(function(given_kws1176, given_argc1177) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1173,given_argc1177-2,true)!==false) {var or_part1178 = M0.not(allowed_kws1175);if (or_part1178!==false) {var if_res674 = or_part1178;} else {var if_res674 = subset_p(given_kws1176,allowed_kws1175);}if (if_res674!==false) {var if_res675 = subset_p(req_kws1174,given_kws1176);} else {var if_res675 = false;}var if_res676 = if_res675;} else {var if_res676 = false;}return if_res676;},$rjs_core.attachProcedureArity(function(kws1179, kw_args1180, ...vals1181673) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1181 = $rjs_core.Pair.listFromArray(vals1181673);return keyword_apply(proc1173,kws1179,kw_args1180,vals1181);}),req_kws1174,allowed_kws1175,proc1173);}var if_res678 = if_res677;} else {var if_res678 = proc1173;}var if_res679 = if_res678;}return if_res679;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };