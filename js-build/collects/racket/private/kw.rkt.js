import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result361 = M0.make_struct_type_property($rjs_core.Symbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result361.getAt(0);var keyword_impersonator_p = let_result361.getAt(1);var keyword_impersonator_ref = let_result361.getAt(2);var keyword_procedure_impersonator_of = function(v804) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v804)!==false) {var if_res362 = keyword_impersonator_ref(v804)(v804);} else {var if_res362 = false;}return if_res362;};var let_result363 = M0.make_struct_type($rjs_core.Symbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result363.getAt(0);var mk_kw_proc = let_result363.getAt(1);var keyword_procedure_p = let_result363.getAt(2);var keyword_procedure_ref = let_result363.getAt(3);var keyword_procedure_set_bang_ = let_result363.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result364 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result364.getAt(0);var make_km = let_result364.getAt(1);var keyword_method_p = let_result364.getAt(2);var km_ref = let_result364.getAt(3);var km_set_bang_ = let_result364.getAt(4);var generate_arity_string = function(proc805) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result365 = procedure_keywords(proc805);var req806 = let_result365.getAt(0);var allowed807 = let_result365.getAt(1);var a808 = M0.procedure_arity(proc805);var keywords_desc809 = function(opt811, req812) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp371 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req812))!==false) {var if_res370 = M0.format($rjs_core.UString.make("an ~aargument"),opt811);} else {var if_res370 = M0.format($rjs_core.UString.make("~aarguments"),opt811);}if (M0.null_p(M0.cdr(req812))!==false) {var if_res369 = $rjs_core.UString.make("");} else {var if_res369 = $rjs_core.UString.make("s");}var tmp813 = M0.length(req812);if (M0.equal_p(tmp813,1)!==false) {var if_res368 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req812));} else {if (M0.equal_p(tmp813,2)!==false) {var if_res367 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req812),M0.cadr(req812));} else {var loop814 = function(req815) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req815))!==false) {var if_res366 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req815));} else {var if_res366 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req815),loop814(M0.cdr(req815)));}return if_res366;};var if_res367 = loop814(req812);}var if_res368 = if_res367;}return M0.format(temp371,if_res370,if_res369,if_res368);};var method_adjust810 = function(a816) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part817 = okm_p(proc805);if (or_part817!==false) {var if_res372 = or_part817;} else {var if_res372 = keyword_method_p(proc805);}if (if_res372!==false) {if (M0.zero_p(a816)!==false) {var if_res373 = 0;} else {var if_res373 = M0.sub1(a816);}var if_res374 = if_res373;} else {var if_res374 = a816;}return if_res374;};if (M0.number_p(a808)!==false) {var a818 = method_adjust810(a808);var if_res381 = M0.format($rjs_core.UString.make("~a"),a818);} else {if (M0.arity_at_least_p(a808)!==false) {var a819 = method_adjust810(M0.arity_at_least_value(a808));var if_res380 = M0.format($rjs_core.UString.make("at least ~a"),a819);} else {var if_res380 = $rjs_core.UString.make("a different number");}var if_res381 = if_res380;}if (M0.null_p(req806)!==false) {var if_res379 = $rjs_core.UString.make("");} else {var if_res379 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc809($rjs_core.UString.make(""),req806));}if (allowed807!==false) {var loop821 = function(req822, allowed823) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req822)!==false) {var if_res376 = allowed823;} else {if (M0.eq_p(M0.car(req822),M0.car(allowed823))!==false) {var if_res375 = loop821(M0.cdr(req822),M0.cdr(allowed823));} else {var if_res375 = M0.cons(M0.car(allowed823),loop821(req822,M0.cdr(allowed823)));}var if_res376 = if_res375;}return if_res376;};var others820 = loop821(req806,allowed807);if (M0.null_p(others820)!==false) {var if_res377 = $rjs_core.UString.make("");} else {var if_res377 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc809($rjs_core.UString.make("optional "),others820));}var if_res378 = if_res377;} else {var if_res378 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res381,if_res379,if_res378);};var let_result382 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result382.getAt(0);var make_optional_keyword_procedure = let_result382.getAt(1);var okp_p = let_result382.getAt(2);var okp_ref = let_result382.getAt(3);var okp_set_bang_ = let_result382.getAt(4);var let_result383 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result383.getAt(0);var make_optional_keyword_method = let_result383.getAt(1);var okm_p = let_result383.getAt(2);var okm_ref = let_result383.getAt(3);var okm_set_bang_ = let_result383.getAt(4);var let_result384 = M0.make_struct_type_property($rjs_core.Symbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result384.getAt(0);var named_keyword_procedure_p = let_result384.getAt(1);var keyword_procedure_name_plus_fail = let_result384.getAt(2);var let_result386 = M0.make_struct_type_property($rjs_core.Symbol.make("procedure"),function(v824, info_l825) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v824)!==false) {var if_res385 = M0.make_struct_field_accessor(M0.list_ref(info_l825,3),v824);} else {var if_res385 = false;}return if_res385;});var prop_procedure_accessor = let_result386.getAt(0);var procedure_accessor_p = let_result386.getAt(1);var procedure_accessor_ref = let_result386.getAt(2);var let_result387 = M0.make_struct_type_property($rjs_core.Symbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result387.getAt(0);var new_procedure_p = let_result387.getAt(1);var new_procedure_ref = let_result387.getAt(2);var let_result388 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v826) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v826,0);})));var struct_keyword_procedure_impersonator = let_result388.getAt(0);var make_kpp = let_result388.getAt(1);var keyword_procedure_impersonator_p = let_result388.getAt(2);var kpp_ref = let_result388.getAt(3);var kpp_set_bang_ = let_result388.getAt(4);var let_result389 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v827) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v827,0);})));var struct_keyword_method_impersonator = let_result389.getAt(0);var make_kmp = let_result389.getAt(1);var keyword_method_impersonator_p = let_result389.getAt(2);var kmp_ref = let_result389.getAt(3);var kmp_set_bang_ = let_result389.getAt(4);var let_result390 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v828) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v828,0);})));var struct_okpp = let_result390.getAt(0);var make_optional_keyword_procedure_impersonator = let_result390.getAt(1);var okpp_p = let_result390.getAt(2);var okpp_ref = let_result390.getAt(3);var okpp_set_bang_ = let_result390.getAt(4);var let_result391 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v829) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v829,0);})));var struct_okmp = let_result391.getAt(0);var make_optional_keyword_method_impersonator = let_result391.getAt(1);var okmp_p = let_result391.getAt(2);var okmp_ref = let_result391.getAt(3);var okmp_set_bang_ = let_result391.getAt(4);var let_result392 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result392.getAt(0);var make_kp_by_ae = let_result392.getAt(1);var kp_by_ae_p = let_result392.getAt(2);var kp_by_ae_ref = let_result392.getAt(3);var kp_by_ae_set_bang_ = let_result392.getAt(4);var let_result393 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result393.getAt(0);var make_km_by_ae = let_result393.getAt(1);var km_by_ae_p = let_result393.getAt(2);var km_by_ae_ref = let_result393.getAt(3);var km_by_ae_set_bang_ = let_result393.getAt(4);var let_result394 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result394.getAt(0);var make_kpi_by_ae = let_result394.getAt(1);var kpi_by_ae_p = let_result394.getAt(2);var kpi_by_ae_ref = let_result394.getAt(3);var kpi_by_ae_set_bang_ = let_result394.getAt(4);var let_result395 = M0.make_struct_type($rjs_core.Symbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result395.getAt(0);var make_kmi_by_ae = let_result395.getAt(1);var kmi_by_ae_p = let_result395.getAt(2);var kmi_by_ae_ref = let_result395.getAt(3);var kmi_by_ae_set_bang_ = let_result395.getAt(4);var make_required = function(name830, fail_proc831, method_p832, impersonator_p833) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part839 = name830;if (or_part839!==false) {var if_res399 = or_part839;} else {var if_res399 = $rjs_core.Symbol.make("unknown");}if (impersonator_p833!==false) {if (method_p832!==false) {var if_res396 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res396 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res398 = if_res396;} else {if (method_p832!==false) {var if_res397 = struct_keyword_method_by_arity_error;} else {var if_res397 = struct_keyword_procedure_by_arity_error;}var if_res398 = if_res397;}var let_result400 = M0.make_struct_type(if_res399,if_res398,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name830,fail_proc831))),M0.current_inspector(),fail_proc831);var s_834 = let_result400.getAt(0);var mk835 = let_result400.getAt(1);var __p836 = let_result400.getAt(2);var __ref837 = let_result400.getAt(3);var __set_bang_838 = let_result400.getAt(4);return mk835;};var cl401 = function(proc840) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name841 = M0.object_name(proc840);var plain_proc842 = $rjs_core.attachProcedureArity(function(...args843404) {var args843 = $rjs_core.Pair.listFromArray(args843404);return M0.apply(proc840,M0.rnull,M0.rnull,args843);});if (M0.symbol_p(proc_name841)!==false) {var if_res405 = M0.__rjs_quoted__.procedure_rename(plain_proc842,proc_name841);} else {var if_res405 = plain_proc842;}return make_keyword_procedure(proc840,if_res405);};var cl402 = function(proc844, plain_proc845) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc844)!==false) {var if_res406 = M0.procedure_arity_mask(proc844);} else {var if_res406 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res406),proc844,M0.rnull,false,plain_proc845);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam403 = {'1':cl401,'2':cl402}[arguments.length];if (fixed_lam403!==undefined) {return fixed_lam403.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc846, kws847, kw_vals848, normal_args849, ...normal_argss850407) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss850 = $rjs_core.Pair.listFromArray(normal_argss850407);var type_error851 = function(what852, which853) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.Symbol.make("keyword-apply"),what852,which853,proc846,kws847,kw_vals848,normal_args849,normal_argss850);};if (M0.procedure_p(proc846)!==false) {var if_res408 = M0.rvoid();} else {var if_res408 = type_error851($rjs_core.UString.make("procedure?"),0);}if_res408;var loop854 = function(ks855) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks855)!==false) {var if_res415 = M0.rvoid();} else {var or_part856 = M0.not(M0.pair_p(ks855));if (or_part856!==false) {var if_res409 = or_part856;} else {var if_res409 = M0.not(M0.keyword_p(M0.car(ks855)));}if (if_res409!==false) {var if_res414 = type_error851($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks855))!==false) {var if_res413 = M0.rvoid();} else {var or_part857 = M0.not(M0.pair_p(M0.cdr(ks855)));if (or_part857!==false) {var if_res410 = or_part857;} else {var if_res410 = M0.not(M0.keyword_p(M0.cadr(ks855)));}if (if_res410!==false) {var if_res412 = loop854(M0.cdr(ks855));} else {if (M0.keyword_lt__p(M0.car(ks855),M0.cadr(ks855))!==false) {var if_res411 = loop854(M0.cdr(ks855));} else {var if_res411 = type_error851($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res412 = if_res411;}var if_res413 = if_res412;}var if_res414 = if_res413;}var if_res415 = if_res414;}return if_res415;};loop854(kws847);if (M0.list_p(kw_vals848)!==false) {var if_res416 = M0.rvoid();} else {var if_res416 = type_error851($rjs_core.UString.make("list?"),2);}if_res416;if (M0.__eq_(M0.length(kws847),M0.length(kw_vals848))!==false) {var if_res417 = M0.rvoid();} else {var if_res417 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws847),$rjs_core.UString.make("value list length"),M0.length(kw_vals848),$rjs_core.UString.make("keyword list"),kws847,$rjs_core.UString.make("value list"),kw_vals848);}if_res417;var loop859 = function(normal_argss860, pos861) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss860))!==false) {var l862 = M0.car(normal_argss860);if (M0.list_p(l862)!==false) {var if_res418 = l862;} else {var if_res418 = type_error851($rjs_core.UString.make("list?"),pos861);}var if_res419 = if_res418;} else {var if_res419 = M0.cons(M0.car(normal_argss860),loop859(M0.cdr(normal_argss860),M0.add1(pos861)));}return if_res419;};var normal_args858 = loop859(M0.cons(normal_args849,normal_argss850),3);if (M0.null_p(kws847)!==false) {var if_res420 = M0.apply(proc846,normal_args858);} else {var if_res420 = M0.apply(keyword_procedure_extract_by_method(kws847,2+M0.length(normal_args858),proc846,0),kws847,kw_vals848,normal_args858);}return if_res420;});var procedure_keywords = function(p863) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p863)!==false) {var if_res425 = M0.values(keyword_procedure_required(p863),keyword_procedure_allowed(p863));} else {if (M0.procedure_p(p863)!==false) {if (new_procedure_p(p863)!==false) {var v864 = new_procedure_ref(p863);if (M0.procedure_p(v864)!==false) {var if_res422 = procedure_keywords(v864);} else {var a865 = procedure_accessor_ref(p863);if (a865!==false) {var if_res421 = procedure_keywords(a865(p863));} else {var if_res421 = M0.values(M0.rnull,M0.rnull);}var if_res422 = if_res421;}var if_res423 = if_res422;} else {var if_res423 = M0.values(M0.rnull,M0.rnull);}var if_res424 = if_res423;} else {var if_res424 = M0.raise_argument_error($rjs_core.Symbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p863);}var if_res425 = if_res424;}return if_res425;};var missing_kw = $rjs_core.attachProcedureArity(function(proc866, ...args867426) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args867 = $rjs_core.Pair.listFromArray(args867426);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc866,0),M0.rnull,M0.rnull,args867);});var check_kw_args = function(p868, kws869) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop870 = function(kws871, required872, allowed873) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws871)!==false) {if (M0.null_p(required872)!==false) {var if_res427 = M0.values(false,false);} else {var if_res427 = M0.values(M0.car(required872),false);}var if_res436 = if_res427;} else {if (M0.pair_p(required872)!==false) {var if_res428 = M0.eq_p(M0.car(required872),M0.car(kws871));} else {var if_res428 = false;}if (if_res428!==false) {var temp431 = M0.cdr(kws871);var temp430 = M0.cdr(required872);if (allowed873!==false) {var if_res429 = M0.cdr(allowed873);} else {var if_res429 = false;}var if_res435 = loop870(temp431,temp430,if_res429);} else {if (M0.not(allowed873)!==false) {var if_res434 = loop870(M0.cdr(kws871),required872,false);} else {if (M0.pair_p(allowed873)!==false) {if (M0.eq_p(M0.car(allowed873),M0.car(kws871))!==false) {var if_res432 = loop870(M0.cdr(kws871),required872,M0.cdr(allowed873));} else {var if_res432 = loop870(kws871,required872,M0.cdr(allowed873));}var if_res433 = if_res432;} else {var if_res433 = M0.values(false,M0.car(kws871));}var if_res434 = if_res433;}var if_res435 = if_res434;}var if_res436 = if_res435;}return if_res436;};return loop870(kws869,keyword_procedure_required(p868),keyword_procedure_allowed(p868));};var make_keyword_checker = function(req_kws874, allowed_kws875, arity_mask876) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws875)!==false) {if (M0.null_p(req_kws874)!==false) {var if_res439 = function(kws877, a878) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res437 = M0.bitwise_bit_set_p(arity_mask876,a878);} else {var if_res437 = false;}return if_res437;};} else {var if_res439 = function(kws879, a880) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws874,kws879)!==false) {var if_res438 = M0.bitwise_bit_set_p(arity_mask876,a880);} else {var if_res438 = false;}return if_res438;};}var if_res452 = if_res439;} else {if (M0.null_p(allowed_kws875)!==false) {var if_res451 = function(kws881, a882) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws881)!==false) {var if_res440 = M0.bitwise_bit_set_p(arity_mask876,a882);} else {var if_res440 = false;}return if_res440;};} else {if (M0.null_p(req_kws874)!==false) {var if_res450 = function(kws883, a884) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws883,allowed_kws875)!==false) {var if_res441 = M0.bitwise_bit_set_p(arity_mask876,a884);} else {var if_res441 = false;}return if_res441;};} else {if (M0.list_p(req_kws874)!==false) {if (M0.list_p(allowed_kws875)!==false) {var if_res442 = M0.eq_p(M0.length(req_kws874),M0.length(allowed_kws875));} else {var if_res442 = false;}var if_res443 = if_res442;} else {var if_res443 = false;}if (if_res443!==false) {var if_res449 = function(kws885, a886) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop887 = function(kws888, req_kws889) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws889)!==false) {var if_res446 = M0.null_p(kws888);} else {if (M0.null_p(kws888)!==false) {var if_res445 = false;} else {if (M0.eq_p(M0.car(kws888),M0.car(req_kws889))!==false) {var if_res444 = loop887(M0.cdr(kws888),M0.cdr(req_kws889));} else {var if_res444 = false;}var if_res445 = if_res444;}var if_res446 = if_res445;}return if_res446;};if (loop887(kws885,req_kws874)!==false) {var if_res447 = M0.bitwise_bit_set_p(arity_mask876,a886);} else {var if_res447 = false;}return if_res447;};} else {var if_res449 = function(kws890, a891) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws874,kws890,allowed_kws875)!==false) {var if_res448 = M0.bitwise_bit_set_p(arity_mask876,a891);} else {var if_res448 = false;}return if_res448;};}var if_res450 = if_res449;}var if_res451 = if_res450;}var if_res452 = if_res451;}return if_res452;};var subset_p = function(l1892, l2893) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1892)!==false) {var if_res455 = true;} else {if (M0.null_p(l2893)!==false) {var if_res454 = false;} else {if (M0.eq_p(M0.car(l1892),M0.car(l2893))!==false) {var if_res453 = subset_p(M0.cdr(l1892),M0.cdr(l2893));} else {var if_res453 = subset_p(l1892,M0.cdr(l2893));}var if_res454 = if_res453;}var if_res455 = if_res454;}return if_res455;};var subsets_p = function(l1894, l2895, l3896) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l1894)!==false) {var if_res460 = subset_p(l2895,l3896);} else {if (M0.null_p(l2895)!==false) {var if_res459 = false;} else {if (M0.null_p(l3896)!==false) {var if_res458 = false;} else {var v2897 = M0.car(l2895);if (M0.eq_p(M0.car(l1894),v2897)!==false) {var if_res457 = subsets_p(M0.cdr(l1894),M0.cdr(l2895),M0.cdr(l3896));} else {if (M0.eq_p(v2897,M0.car(l3896))!==false) {var if_res456 = subsets_p(l1894,M0.cdr(l2895),M0.cdr(l3896));} else {var if_res456 = subsets_p(l1894,l2895,M0.cdr(l3896));}var if_res457 = if_res456;}var if_res458 = if_res457;}var if_res459 = if_res458;}var if_res460 = if_res459;}return if_res460;};var keyword_procedure_extract_by_method = function(kws898, n899, p900, method_n901) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p900)!==false) {var if_res461 = keyword_procedure_checker(p900)(kws898,n899);} else {var if_res461 = false;}if (if_res461!==false) {var if_res491 = keyword_procedure_proc(p900);} else {if (M0.not(keyword_procedure_p(p900))!==false) {if (M0.procedure_p(p900)!==false) {if (new_procedure_p(p900)!==false) {var a904 = procedure_accessor_ref(p900);if (a904!==false) {var if_res462 = a904(p900);} else {var if_res462 = false;}var if_res463 = if_res462;} else {var if_res463 = false;}var or_part903 = if_res463;if (or_part903!==false) {var if_res466 = or_part903;} else {var or_part905 = M0.procedure_extract_target(p900);if (or_part905!==false) {var if_res465 = or_part905;} else {if (new_procedure_p(p900)!==false) {var if_res464 = $rjs_core.Symbol.make("method");} else {var if_res464 = false;}var if_res465 = if_res464;}var if_res466 = if_res465;}var if_res467 = if_res466;} else {var if_res467 = false;}var if_res468 = if_res467;} else {var if_res468 = false;}var p2902 = if_res468;if (p2902!==false) {if (M0.eq_p(p2902,$rjs_core.Symbol.make("method"))!==false) {var p3906 = keyword_procedure_extract_by_method(kws898,M0.add1(n899),new_procedure_ref(p900),M0.add1(method_n901));var if_res470 = $rjs_core.attachProcedureArity(function(kws907, kw_args908, ...args909469) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args909 = $rjs_core.Pair.listFromArray(args909469);return M0.apply(p3906,kws907,kw_args908,M0.cons(p900,args909));});} else {var if_res470 = keyword_procedure_extract_by_method(kws898,n899,p2902,method_n901);}var if_res490 = if_res470;} else {var if_res490 = $rjs_core.attachProcedureArity(function(kws910, kw_args911, ...args912471) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args912 = $rjs_core.Pair.listFromArray(args912471);if (keyword_procedure_p(p900)!==false) {var if_res472 = check_kw_args(p900,kws910);} else {var if_res472 = M0.values(false,M0.car(kws910));}var let_result473 = if_res472;var missing_kw913 = let_result473.getAt(0);var extra_kw914 = let_result473.getAt(1);var or_part919 = keyword_method_p(p900);if (or_part919!==false) {var if_res474 = or_part919;} else {var if_res474 = okm_p(p900);}if (if_res474!==false) {var if_res475 = 1;} else {var if_res475 = 0;}var method_n918 = method_n901+if_res475;if (M0.__gt__eq_(n899,method_n918)!==false) {var if_res476 = n899-method_n918;} else {var if_res476 = n899;}var n915 = if_res476;if (M0.null_p(args912)!==false) {var if_res477 = M0.null_p(kws910);} else {var if_res477 = false;}if (if_res477!==false) {var if_res478 = $rjs_core.UString.make("");} else {var if_res478 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v920) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v920);},args912),M0.map(function(kw921, kw_arg922) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw921,kw_arg922);},kws910,kw_args911)));}var args_str916 = if_res478;var proc_name917 = function(p923) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p923)!==false) {var if_res479 = M0.car(keyword_procedure_name_plus_fail(p923));} else {var if_res479 = false;}var or_part924 = if_res479;if (or_part924!==false) {var if_res481 = or_part924;} else {var or_part925 = M0.object_name(p923);if (or_part925!==false) {var if_res480 = or_part925;} else {var if_res480 = p923;}var if_res481 = if_res480;}return if_res481;};var or_part926 = extra_kw914;if (or_part926!==false) {var if_res488 = or_part926;} else {var if_res488 = missing_kw913;}if (if_res488!==false) {var if_res489 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res489 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw914!==false) {if (keyword_procedure_p(p900)!==false) {var if_res483 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name917(p900),extra_kw914,args_str916);} else {if (M0.procedure_p(p900)!==false) {var if_res482 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name917(p900),args_str916);} else {var if_res482 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p900,args_str916);}var if_res483 = if_res482;}var if_res487 = if_res483;} else {if (missing_kw913!==false) {var if_res486 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name917(p900),missing_kw913,args_str916);} else {var temp485 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n915-2)!==false) {var if_res484 = $rjs_core.UString.make("");} else {var if_res484 = $rjs_core.UString.make("s");}var if_res486 = M0.format(temp485,n915-2,if_res484,proc_name917(p900),args_str916);}var if_res487 = if_res486;}return M0.raise(if_res489(if_res487,M0.current_continuation_marks()));});}var if_res491 = if_res490;}return if_res491;};var keyword_procedure_extract = function(p927, kws928, n929) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws928,n929,p927,0);};var cl492 = function(proc930, arity931, req_kw932, allowed_kw933, name934) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity"),proc930,arity931,false,name934,req_kw932,allowed_kw933);};var cl493 = function(proc935, arity936, req_kw937, allowed_kw938) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity"),proc935,arity936,false,false,req_kw937,allowed_kw938);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam494 = {'5':cl492,'4':cl493}[arguments.length];if (fixed_lam494!==undefined) {return fixed_lam494.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl495 = function(proc939, mask940, req_kw941, allowed_kw942, name943) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity-mask"),proc939,false,mask940,name943,req_kw941,allowed_kw942);};var cl496 = function(proc944, mask945, req_kw946, allowed_kw947) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.Symbol.make("procedure-reduce-keyword-arity-mask"),proc944,false,mask945,false,req_kw946,allowed_kw947);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam497 = {'5':cl495,'4':cl496}[arguments.length];if (fixed_lam497!==undefined) {return fixed_lam497.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who948, proc949, arity950, mask951, name952, req_kw953, allowed_kw954) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc949)!==false) {var if_res498 = okp_ref(proc949,0);} else {var if_res498 = proc949;}var p956 = if_res498;if (arity950!==false) {var if_res499 = M0.__rjs_quoted__.procedure_reduce_arity(p956,arity950);} else {var if_res499 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p956,mask951,name952);}var plain_proc955 = if_res499;var sorted_p957 = function(kws958) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop959 = function(kws960) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws960)!==false) {var if_res502 = true;} else {if (M0.null_p(M0.cdr(kws960))!==false) {var if_res501 = true;} else {if (M0.keyword_lt__p(M0.car(kws960),M0.cadr(kws960))!==false) {var if_res500 = loop959(M0.cdr(kws960));} else {var if_res500 = false;}var if_res501 = if_res500;}var if_res502 = if_res501;}return if_res502;};return loop959(kws958);};if (M0.list_p(req_kw953)!==false) {if (M0.andmap(M0.keyword_p,req_kw953)!==false) {var if_res503 = sorted_p957(req_kw953);} else {var if_res503 = false;}var if_res504 = if_res503;} else {var if_res504 = false;}if (if_res504!==false) {var if_res507 = M0.rvoid();} else {var temp506 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part961 = arity950;if (or_part961!==false) {var if_res505 = or_part961;} else {var if_res505 = mask951;}var if_res507 = M0.raise_argument_error(who948,temp506,2,proc949,if_res505,req_kw953,allowed_kw954);}if_res507;if (allowed_kw954!==false) {if (M0.list_p(allowed_kw954)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw954)!==false) {var if_res508 = sorted_p957(allowed_kw954);} else {var if_res508 = false;}var if_res509 = if_res508;} else {var if_res509 = false;}if (if_res509!==false) {var if_res512 = M0.rvoid();} else {var temp511 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part962 = arity950;if (or_part962!==false) {var if_res510 = or_part962;} else {var if_res510 = mask951;}var if_res512 = M0.raise_argument_error(who948,temp511,3,proc949,if_res510,req_kw953,allowed_kw954);}if_res512;if (subset_p(req_kw953,allowed_kw954)!==false) {var if_res513 = M0.rvoid();} else {var if_res513 = M0.raise_arguments_error(who948,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw954,$rjs_core.UString.make("required keywords"),req_kw953);}var if_res514 = if_res513;} else {var if_res514 = M0.rvoid();}if_res514;var let_result515 = procedure_keywords(proc949);var old_req963 = let_result515.getAt(0);var old_allowed964 = let_result515.getAt(1);if (subset_p(old_req963,req_kw953)!==false) {var if_res516 = M0.rvoid();} else {var if_res516 = M0.raise_arguments_error(who948,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req963,$rjs_core.UString.make("requested required keywords"),req_kw953);}if_res516;if (old_allowed964!==false) {if (subset_p(req_kw953,old_allowed964)!==false) {var if_res517 = M0.rvoid();} else {var if_res517 = M0.raise_arguments_error(who948,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed964,$rjs_core.UString.make("requested required keywords"),req_kw953);}if_res517;var or_part965 = M0.not(allowed_kw954);if (or_part965!==false) {var if_res518 = or_part965;} else {var if_res518 = subset_p(allowed_kw954,old_allowed964);}if (if_res518!==false) {var if_res519 = M0.rvoid();} else {var if_res519 = M0.raise_arguments_error(who948,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed964,$rjs_core.UString.make("requested allowed keywords"),allowed_kw954);}var if_res520 = if_res519;} else {var if_res520 = M0.rvoid();}if_res520;if (M0.null_p(allowed_kw954)!==false) {var if_res528 = plain_proc955;} else {var or_part967 = mask951;if (or_part967!==false) {var if_res521 = or_part967;} else {var if_res521 = arity__gt_mask(arity950);}var mask966 = if_res521;var new_mask968 = M0.arithmetic_shift(mask966,2);var kw_checker969 = make_keyword_checker(req_kw953,allowed_kw954,new_mask968);var proc970 = normalize_proc(proc949);var new_kw_proc971 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc970),new_mask968);if (M0.null_p(req_kw953)!==false) {if (okm_p(proc970)!==false) {var if_res522 = make_optional_keyword_method;} else {var if_res522 = make_optional_keyword_procedure;}var if_res527 = if_res522(kw_checker969,new_kw_proc971,req_kw953,allowed_kw954,plain_proc955);} else {if (named_keyword_procedure_p(proc970)!==false) {var if_res525 = M0.car(keyword_procedure_name_plus_fail(proc970));} else {var if_res525 = false;}var or_part972 = if_res525;if (or_part972!==false) {var if_res526 = or_part972;} else {var if_res526 = M0.object_name(proc970);}var temp524 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask966,1));var or_part973 = okm_p(proc970);if (or_part973!==false) {var if_res523 = or_part973;} else {var if_res523 = keyword_method_p(proc970);}var if_res527 = make_required(if_res526,temp524,if_res523,false)(kw_checker969,new_kw_proc971,req_kw953,allowed_kw954);}var if_res528 = if_res527;}return if_res528;};var arity__gt_mask = function(a974) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a974)!==false) {var if_res534 = M0.arithmetic_shift(1,a974);} else {if (M0.arity_at_least_p(a974)!==false) {var if_res533 = M0.__rjs_quoted__.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a974))));} else {if (M0.list_p(a974)!==false) {var loop975 = function(mask976, l977) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l977)!==false) {var if_res531 = mask976;} else {var a978 = M0.car(l977);var or_part979 = M0.exact_nonnegative_integer_p(a978);if (or_part979!==false) {var if_res529 = or_part979;} else {var if_res529 = M0.arity_at_least_p(a978);}if (if_res529!==false) {var if_res530 = loop975(M0.__rjs_quoted__.bitwise_ior(mask976,arity__gt_mask(a978)),M0.cdr(l977));} else {var if_res530 = false;}var if_res531 = if_res530;}return if_res531;};var if_res532 = loop975(0,a974);} else {var if_res532 = false;}var if_res533 = if_res532;}var if_res534 = if_res533;}return if_res534;};var cl535 = function(proc981, arity982, name983) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc981)!==false) {var let_result538 = procedure_keywords(proc981);var req984 = let_result538.getAt(0);var allows985 = let_result538.getAt(1);if (M0.pair_p(req984)!==false) {var if_res539 = M0.not(M0.null_p(arity982));} else {var if_res539 = false;}var if_res540 = if_res539;} else {var if_res540 = false;}if (if_res540!==false) {var if_res542 = M0.raise_arguments_error($rjs_core.Symbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc981);} else {if (okm_p(proc981)!==false) {var if_res541 = M0.__rjs_quoted__.procedure__gt_method(proc981);} else {var if_res541 = proc981;}var if_res542 = M0.__rjs_quoted__.procedure_reduce_arity(if_res541,arity982,name983);}return if_res542;};var cl536 = function(proc986, arity987) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc986,arity987,false);};var procedure_reduce_arity980 = $rjs_core.attachProcedureArity(function() {var fixed_lam537 = {'3':cl535,'2':cl536}[arguments.length];if (fixed_lam537!==undefined) {return fixed_lam537.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity980;var cl543 = function(proc989, mask990, name991) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc989)!==false) {var let_result546 = procedure_keywords(proc989);var req992 = let_result546.getAt(0);var allows993 = let_result546.getAt(1);if (M0.pair_p(req992)!==false) {var if_res547 = M0.not(M0.eqv_p(mask990,0));} else {var if_res547 = false;}var if_res548 = if_res547;} else {var if_res548 = false;}if (if_res548!==false) {var if_res550 = M0.raise_arguments_error($rjs_core.Symbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc989);} else {if (okm_p(proc989)!==false) {var if_res549 = M0.__rjs_quoted__.procedure__gt_method(proc989);} else {var if_res549 = proc989;}var if_res550 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res549,mask990,name991);}return if_res550;};var cl544 = function(proc994, mask995) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc994,mask995,false);};var procedure_reduce_arity988 = $rjs_core.attachProcedureArity(function() {var fixed_lam545 = {'3':cl543,'2':cl544}[arguments.length];if (fixed_lam545!==undefined) {return fixed_lam545.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity988;var procedure__gt_method996 = function(proc997) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc998 = normalize_proc(proc997);if (keyword_procedure_p(proc998)!==false) {if (okm_p(proc998)!==false) {var if_res553 = proc998;} else {if (keyword_method_p(proc998)!==false) {var if_res552 = proc998;} else {if (okp_p(proc998)!==false) {var if_res551 = make_optional_keyword_method(keyword_procedure_checker(proc998),keyword_procedure_proc(proc998),keyword_procedure_required(proc998),keyword_procedure_allowed(proc998),okp_ref(proc998,0));} else {var name_plus_fail999 = keyword_procedure_name_plus_fail(proc998);var mk1000 = make_required(M0.car(name_plus_fail999),M0.cdr(name_plus_fail999),true,false);var if_res551 = mk1000(keyword_procedure_checker(proc998),keyword_procedure_proc(proc998),keyword_procedure_required(proc998),keyword_procedure_allowed(proc998));}var if_res552 = if_res551;}var if_res553 = if_res552;}var if_res554 = if_res553;} else {var if_res554 = M0.__rjs_quoted__.procedure__gt_method(proc998);}return if_res554;};var new_procedure__gt_method = procedure__gt_method996;var procedure_rename1001 = function(proc1002, name1003) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1002)!==false) {var if_res555 = M0.symbol_p(name1003);} else {var if_res555 = false;}if (M0.not(if_res555)!==false) {var if_res558 = M0.__rjs_quoted__.procedure_rename(proc1002,name1003);} else {if (okp_p(proc1002)!==false) {if (okm_p(proc1002)!==false) {var if_res556 = make_optional_keyword_method;} else {var if_res556 = make_optional_keyword_procedure;}var if_res557 = if_res556(keyword_procedure_checker(proc1002),keyword_procedure_proc(proc1002),keyword_procedure_required(proc1002),keyword_procedure_allowed(proc1002),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1002,0),name1003));} else {var name_plus_fail1004 = keyword_procedure_name_plus_fail(proc1002);var mk1005 = make_required(name1003,M0.cdr(name_plus_fail1004),keyword_method_p(proc1002),false);var if_res557 = mk1005(keyword_procedure_checker(proc1002),keyword_procedure_proc(proc1002),keyword_procedure_required(proc1002),keyword_procedure_allowed(proc1002));}var if_res558 = if_res557;}return if_res558;};var new_procedure_rename = procedure_rename1001;var chaperone_procedure1006 = $rjs_core.attachProcedureArity(function(proc1007, wrap_proc1008, ...props1009559) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1009 = $rjs_core.Pair.listFromArray(props1009559);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.Symbol.make("chaperone-procedure"),proc1007,wrap_proc1008,props1009);});var new_chaperone_procedure = chaperone_procedure1006;var unsafe_chaperone_procedure1010 = $rjs_core.attachProcedureArity(function(proc1011, wrap_proc1012, ...props1013560) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1013 = $rjs_core.Pair.listFromArray(props1013560);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.Symbol.make("unsafe-chaperone-procedure"),proc1011,wrap_proc1012,props1013);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1010;var impersonate_procedure1014 = $rjs_core.attachProcedureArity(function(proc1015, wrap_proc1016, ...props1017561) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1017 = $rjs_core.Pair.listFromArray(props1017561);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.Symbol.make("impersonate-procedure"),proc1015,wrap_proc1016,props1017);});var new_impersonate_procedure = impersonate_procedure1014;var unsafe_impersonate_procedure1018 = $rjs_core.attachProcedureArity(function(proc1019, wrap_proc1020, ...props1021562) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1021 = $rjs_core.Pair.listFromArray(props1021562);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.Symbol.make("unsafe-impersonate-procedure"),proc1019,wrap_proc1020,props1021);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1018;var chaperone_procedure_times_1022 = $rjs_core.attachProcedureArity(function(proc1023, wrap_proc1024, ...props1025563) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1025 = $rjs_core.Pair.listFromArray(props1025563);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.Symbol.make("chaperone-procedure"),proc1023,wrap_proc1024,props1025);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1022;var impersonate_procedure_times_1026 = $rjs_core.attachProcedureArity(function(proc1027, wrap_proc1028, ...props1029564) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props1029 = $rjs_core.Pair.listFromArray(props1029564);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.Symbol.make("impersonate-procedure"),proc1027,wrap_proc1028,props1029);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1026;var do_chaperone_procedure = function(is_impersonator_p1030, self_arg_p1031, chaperone_procedure1032, name1033, proc1034, wrap_proc1035, props1036) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1037 = normalize_proc(proc1034);var n_wrap_proc1038 = normalize_proc(wrap_proc1035);var or_part1039 = M0.not(keyword_procedure_p(n_proc1037));if (or_part1039!==false) {var if_res566 = or_part1039;} else {var or_part1040 = M0.not(M0.procedure_p(wrap_proc1035));if (or_part1040!==false) {var if_res565 = or_part1040;} else {var if_res565 = bad_props_p(props1036);}var if_res566 = if_res565;}if (if_res566!==false) {var if_res630 = M0.apply(chaperone_procedure1032,proc1034,wrap_proc1035,props1036);} else {chaperone_arity_match_checking(self_arg_p1031,name1033,proc1034,wrap_proc1035,props1036);var p1042 = keyword_procedure_proc(n_wrap_proc1038);if (self_arg_p1031!==false) {var cl567 = $rjs_core.attachProcedureArity(function(self_proc1043, kws1044, args1045, ...rest1046572) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1046 = $rjs_core.Pair.listFromArray(rest1046572);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1042,kws1044,args1045,self_proc1043,rest1046);},$rjs_core.attachProcedureArity(function(...results1047573) {var results1047 = $rjs_core.Pair.listFromArray(results1047573);var len1048 = M0.length(results1047);var alen1049 = M0.length(rest1046);if (M0.__lt_(len1048,alen1049+1)!==false) {var if_res574 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1049+1,$rjs_core.UString.make("received number of results"),len1048,$rjs_core.UString.make("wrapper procedure"),wrap_proc1035);} else {var if_res574 = M0.rvoid();}if_res574;var num_extra1050 = len1048-(alen1049+1);var new_args1051 = M0.list_ref(results1047,num_extra1050);if (M0.list_p(new_args1051)!==false) {var if_res575 = M0.__eq_(M0.length(new_args1051),M0.length(args1045));} else {var if_res575 = false;}if (if_res575!==false) {var if_res579 = M0.rvoid();} else {var temp578 = $rjs_core.Symbol.make("keyword procedure chaperone");var temp577 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1048,alen1049)!==false) {var if_res576 = $rjs_core.UString.make("");} else {var if_res576 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res579 = M0.raise_arguments_error(temp578,M0.format(temp577,if_res576),$rjs_core.UString.make("first result"),new_args1051,$rjs_core.UString.make("wrapper procedure"),wrap_proc1035);}if_res579;M0.for_each(function(kw1052, new_arg1053, arg1054) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1030!==false) {var if_res581 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1053,arg1054)!==false) {var if_res580 = M0.rvoid();} else {var if_res580 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1052),$rjs_core.UString.make("result"),new_arg1053,$rjs_core.UString.make("wrapper procedure"),wrap_proc1035);}var if_res581 = if_res580;}return if_res581;},kws1044,new_args1051,args1045);var tmp1055 = num_extra1050;if (M0.equal_p(tmp1055,0)!==false) {var if_res584 = M0.apply(M0.values,kws1044,results1047);} else {if (M0.equal_p(tmp1055,1)!==false) {var if_res583 = M0.apply(M0.values,M0.car(results1047),kws1044,M0.cdr(results1047));} else {var loop1056 = function(results1057, c1058) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1058)!==false) {var if_res582 = M0.cons(kws1044,results1057);} else {var if_res582 = M0.cons(M0.car(results1057),loop1056(M0.cdr(results1057),M0.sub1(c1058)));}return if_res582;};var if_res583 = M0.apply(M0.values,loop1056(results1047,num_extra1050));}var if_res584 = if_res583;}return if_res584;}));});var cl568 = $rjs_core.attachProcedureArity(function(...other1059585) {var other1059 = $rjs_core.Pair.listFromArray(other1059585);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res605 = $rjs_core.attachProcedureArity(function() {var fixed_lam569 = {}[arguments.length];if (fixed_lam569!==undefined) {return fixed_lam569.apply(null,arguments);} else {if (M0.__gt__eq_(cl567.length,1)!==false) {var if_res571 = cl567.apply(null,arguments);} else {if (true!==false) {var if_res570 = cl568.apply(null,arguments);} else {var if_res570 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res571 = if_res570;}return if_res571;}},[M0.make_arity_at_least(0)]);} else {var cl586 = $rjs_core.attachProcedureArity(function(kws1060, args1061, ...rest1062591) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest1062 = $rjs_core.Pair.listFromArray(rest1062591);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p1042,kws1060,args1061,rest1062);},$rjs_core.attachProcedureArity(function(...results1063592) {var results1063 = $rjs_core.Pair.listFromArray(results1063592);var len1064 = M0.length(results1063);var alen1065 = M0.length(rest1062);if (M0.__lt_(len1064,alen1065+1)!==false) {var if_res593 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1065+1,$rjs_core.UString.make("received number of results"),len1064,$rjs_core.UString.make("wrapper procedure"),wrap_proc1035);} else {var if_res593 = M0.rvoid();}if_res593;var num_extra1066 = len1064-(alen1065+1);var new_args1067 = M0.list_ref(results1063,num_extra1066);if (M0.list_p(new_args1067)!==false) {var if_res594 = M0.__eq_(M0.length(new_args1067),M0.length(args1061));} else {var if_res594 = false;}if (if_res594!==false) {var if_res598 = M0.rvoid();} else {var temp597 = $rjs_core.Symbol.make("keyword procedure chaperone");var temp596 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1064,alen1065)!==false) {var if_res595 = $rjs_core.UString.make("");} else {var if_res595 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res598 = M0.raise_arguments_error(temp597,M0.format(temp596,if_res595),$rjs_core.UString.make("first result"),new_args1067,$rjs_core.UString.make("wrapper procedure"),wrap_proc1035);}if_res598;M0.for_each(function(kw1068, new_arg1069, arg1070) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1030!==false) {var if_res600 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1069,arg1070)!==false) {var if_res599 = M0.rvoid();} else {var if_res599 = M0.raise_arguments_error($rjs_core.Symbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1068),$rjs_core.UString.make("result"),new_arg1069,$rjs_core.UString.make("wrapper procedure"),wrap_proc1035);}var if_res600 = if_res599;}return if_res600;},kws1060,new_args1067,args1061);var tmp1071 = num_extra1066;if (M0.equal_p(tmp1071,0)!==false) {var if_res603 = M0.apply(M0.values,kws1060,results1063);} else {if (M0.equal_p(tmp1071,1)!==false) {var if_res602 = M0.apply(M0.values,M0.car(results1063),kws1060,M0.cdr(results1063));} else {var loop1072 = function(results1073, c1074) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c1074)!==false) {var if_res601 = M0.cons(kws1060,results1073);} else {var if_res601 = M0.cons(M0.car(results1073),loop1072(M0.cdr(results1073),M0.sub1(c1074)));}return if_res601;};var if_res602 = M0.apply(M0.values,loop1072(results1063,num_extra1066));}var if_res603 = if_res602;}return if_res603;}));});var cl587 = $rjs_core.attachProcedureArity(function(...other1075604) {var other1075 = $rjs_core.Pair.listFromArray(other1075604);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res605 = $rjs_core.attachProcedureArity(function() {var fixed_lam588 = {}[arguments.length];if (fixed_lam588!==undefined) {return fixed_lam588.apply(null,arguments);} else {if (M0.__gt__eq_(cl586.length,1)!==false) {var if_res590 = cl586.apply(null,arguments);} else {if (true!==false) {var if_res589 = cl587.apply(null,arguments);} else {var if_res589 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res590 = if_res589;}return if_res590;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1041 = if_res605;var wrap1078 = function(proc1079, n_proc1080) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc1080,proc1079))!==false) {var if_res606 = new_procedure_p(proc1079);} else {var if_res606 = false;}if (if_res606!==false) {var v1081 = new_procedure_ref(proc1079);if (M0.exact_integer_p(v1081)!==false) {var acc1082 = procedure_accessor_ref(proc1079);var if_res622 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc1079,acc1082,function(self1083, sub_proc1084) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result607 = wrap1078(sub_proc1084,normalize_proc(sub_proc1084));var f1085 = let_result607.getAt(0);var acc1086 = let_result607.getAt(1);return f1085;}),acc1082);} else {if (is_impersonator_p1030!==false) {var if_res621 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res621 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc1080)!==false) {var if_res620 = chaperone_procedure1032(proc1079,wrap_proc1035);} else {var if_res620 = proc1079;}var new_kw_proc1087 = if_res621(if_res620,new_procedure_ref,function(self1088, proc1089) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p1030!==false) {var if_res619 = new_impersonate_procedure;} else {var if_res619 = new_chaperone_procedure;}if (self_arg_p1031!==false) {var if_res618 = $rjs_core.attachProcedureArity(function(proc_self1090, kws1091, kw_args1092, self1093, ...args1094608) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1094 = $rjs_core.Pair.listFromArray(args1094608);var len1095 = M0.length(args1094);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1041,proc_self1090,kws1091,kw_args1092,args1094);},$rjs_core.attachProcedureArity(function(...results1096609) {var results1096 = $rjs_core.Pair.listFromArray(results1096609);var r_len1097 = M0.length(results1096);var list_take1098 = function(l1099, n1100) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1100)!==false) {var if_res610 = M0.rnull;} else {var if_res610 = M0.cons(M0.car(l1099),list_take1098(M0.cdr(l1099),M0.sub1(n1100)));}return if_res610;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.Symbol.make("proc-self")))!==false) {var if_res611 = M0.__eq_(r_len1097,2+len1095);} else {var if_res611 = false;}if (if_res611!==false) {var if_res612 = M0.apply(M0.values,M0.cadr(results1096),self1093,M0.cddr(results1096));} else {var skip1101 = r_len1097-len1095;var if_res612 = M0.apply(M0.values,M0.append(list_take1098(results1096,skip1101-2),M0.list(M0.list_ref(results1096,M0.sub1(skip1101)),self1093),M0.__rjs_quoted__.list_tail(results1096,skip1101)));}return if_res612;}));});} else {var if_res618 = $rjs_core.attachProcedureArity(function(kws1102, kw_args1103, self1104, ...args1105613) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args1105 = $rjs_core.Pair.listFromArray(args1105613);var len1106 = M0.length(args1105);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone1041,kws1102,kw_args1103,args1105);},$rjs_core.attachProcedureArity(function(...results1107614) {var results1107 = $rjs_core.Pair.listFromArray(results1107614);var r_len1108 = M0.length(results1107);var list_take1109 = function(l1110, n1111) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n1111)!==false) {var if_res615 = M0.rnull;} else {var if_res615 = M0.cons(M0.car(l1110),list_take1109(M0.cdr(l1110),M0.sub1(n1111)));}return if_res615;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res616 = M0.__eq_(r_len1108,2+len1106);} else {var if_res616 = false;}if (if_res616!==false) {var if_res617 = M0.apply(M0.values,M0.cadr(results1107),self1104,M0.cddr(results1107));} else {var skip1112 = r_len1108-len1106;var if_res617 = M0.apply(M0.values,M0.append(list_take1109(results1107,skip1112-2),M0.list(M0.list_ref(results1107,M0.sub1(skip1112)),self1104),M0.__rjs_quoted__.list_tail(results1107,skip1112)));}return if_res617;}));});}return if_res619(proc1089,make_keyword_procedure(if_res618));});var if_res622 = M0.values(new_kw_proc1087,new_procedure_ref);}var if_res627 = if_res622;} else {if (okp_p(n_proc1080)!==false) {if (is_impersonator_p1030!==false) {if (okm_p(n_proc1080)!==false) {var if_res623 = make_optional_keyword_method_impersonator;} else {var if_res623 = make_optional_keyword_procedure_impersonator;}var if_res624 = if_res623(keyword_procedure_checker(n_proc1080),chaperone_procedure1032(keyword_procedure_proc(n_proc1080),kw_chaperone1041),keyword_procedure_required(n_proc1080),keyword_procedure_allowed(n_proc1080),chaperone_procedure1032(okp_ref(n_proc1080,0),okp_ref(n_wrap_proc1038,0)),n_proc1080);} else {var if_res624 = M0.__rjs_quoted__.chaperone_struct(proc1079,keyword_procedure_proc,function(self1113, proc1114) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1032(proc1114,kw_chaperone1041);},M0.make_struct_field_accessor(okp_ref,0),function(self1115, proc1116) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1032(proc1116,okp_ref(n_wrap_proc1038,0));});}var if_res626 = M0.values(if_res624,keyword_procedure_proc);} else {if (is_impersonator_p1030!==false) {var name_plus_fail1117 = keyword_procedure_name_plus_fail(n_proc1080);var mk1118 = make_required(M0.car(name_plus_fail1117),M0.cdr(name_plus_fail1117),keyword_method_p(n_proc1080),true);var if_res625 = mk1118(keyword_procedure_checker(n_proc1080),chaperone_procedure1032(keyword_procedure_proc(n_proc1080),kw_chaperone1041),keyword_procedure_required(n_proc1080),keyword_procedure_allowed(n_proc1080),n_proc1080);} else {var if_res625 = M0.__rjs_quoted__.chaperone_struct(n_proc1080,keyword_procedure_proc,function(self1119, proc1120) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure1032(proc1120,kw_chaperone1041);});}var if_res626 = M0.values(if_res625,keyword_procedure_proc);}var if_res627 = if_res626;}return if_res627;};var let_result628 = wrap1078(proc1034,n_proc1037);var new_proc1076 = let_result628.getAt(0);var chap_accessor1077 = let_result628.getAt(1);if (M0.null_p(props1036)!==false) {var if_res629 = new_proc1076;} else {var if_res629 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc1076,chap_accessor1077,false,props1036);}var if_res630 = if_res629;}return if_res630;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure1121, name1122, proc1123, wrap_proc1124, props1125) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc1126 = normalize_proc(proc1123);var n_wrap_proc1127 = normalize_proc(wrap_proc1124);var or_part1128 = M0.not(keyword_procedure_p(n_proc1126));if (or_part1128!==false) {var if_res632 = or_part1128;} else {var or_part1129 = M0.not(M0.procedure_p(wrap_proc1124));if (or_part1129!==false) {var if_res631 = or_part1129;} else {var if_res631 = bad_props_p(props1125);}var if_res632 = if_res631;}if (if_res632!==false) {var if_res633 = M0.apply(unsafe_chaperone_procedure1121,proc1123,wrap_proc1124,props1125);} else {chaperone_arity_match_checking(false,name1122,proc1123,wrap_proc1124,props1125);var if_res633 = M0.apply(unsafe_chaperone_procedure1121,proc1123,wrap_proc1124,props1125);}return if_res633;};var bad_props_p = function(props1130) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop1131 = function(props1132) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props1132)!==false) {var if_res636 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props1132))!==false) {var props1133 = M0.cdr(props1132);var or_part1134 = M0.null_p(props1133);if (or_part1134!==false) {var if_res634 = or_part1134;} else {var if_res634 = loop1131(M0.cdr(props1133));}var if_res635 = if_res634;} else {var if_res635 = true;}var if_res636 = if_res635;}return if_res636;};return loop1131(props1130);};var chaperone_arity_match_checking = function(self_arg_p1135, name1136, proc1137, wrap_proc1138, props1139) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a1140 = M0.procedure_arity(proc1137);var b1141 = M0.procedure_arity(wrap_proc1138);if (self_arg_p1135!==false) {var if_res637 = 1;} else {var if_res637 = 0;}var d1142 = if_res637;var let_result638 = procedure_keywords(proc1137);var a_req1143 = let_result638.getAt(0);var a_allow1144 = let_result638.getAt(1);var let_result639 = procedure_keywords(wrap_proc1138);var b_req1145 = let_result639.getAt(0);var b_allow1146 = let_result639.getAt(1);var includes_p1147 = function(a1148, b1149) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b1149)!==false) {if (M0.number_p(a1148)!==false) {var if_res641 = M0.__eq_(b1149,a1148+d1142);} else {if (M0.arity_at_least_p(a1148)!==false) {var if_res640 = M0.__gt__eq_(b1149,M0.arity_at_least_value(a1148)+d1142);} else {var if_res640 = M0.ormap(function(a1150) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1147(a1150,b1149);},a1148);}var if_res641 = if_res640;}var if_res645 = if_res641;} else {if (M0.arity_at_least_p(b1149)!==false) {if (M0.number_p(a1148)!==false) {var if_res643 = false;} else {if (M0.arity_at_least_p(a1148)!==false) {var if_res642 = M0.__gt__eq_(M0.arity_at_least_value(b1149),M0.arity_at_least_value(a1148)+d1142);} else {var if_res642 = M0.ormap(function(a1151) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1147(b1149,a1151);},a1148);}var if_res643 = if_res642;}var if_res644 = if_res643;} else {var if_res644 = M0.andmap(function(b1152) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p1147(a1148,b1152);},b1149);}var if_res645 = if_res644;}return if_res645;};if (includes_p1147(b1141,a1140)!==false) {var if_res646 = M0.rvoid();} else {var if_res646 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc1137,wrap_proc1138,props1139);}if_res646;if (subset_p(b_req1145,a_req1143)!==false) {var if_res647 = M0.rvoid();} else {var if_res647 = M0.raise_arguments_error(name1136,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1138,$rjs_core.UString.make("original procedure"),proc1137);}if_res647;var or_part1153 = M0.not(b_allow1146);if (or_part1153!==false) {var if_res649 = or_part1153;} else {if (a_allow1144!==false) {var if_res648 = subset_p(a_allow1144,b_allow1146);} else {var if_res648 = false;}var if_res649 = if_res648;}if (if_res649!==false) {var if_res650 = M0.rvoid();} else {var if_res650 = M0.raise_arguments_error(name1136,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc1138,$rjs_core.UString.make("original procedure"),proc1137);}if_res650;return M0.rvoid();};var normalize_proc = function(proc1154) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc1154)!==false) {var if_res658 = proc1154;} else {if (new_procedure_p(proc1154)!==false) {var let_result651 = procedure_keywords(proc1154);var req_kws1155 = let_result651.getAt(0);var allowed_kws1156 = let_result651.getAt(1);if (M0.null_p(allowed_kws1156)!==false) {var if_res656 = proc1154;} else {var if_res656 = make_optional_keyword_procedure(function(given_kws1157, given_argc1158) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc1154,given_argc1158-2,true)!==false) {var or_part1159 = M0.not(allowed_kws1156);if (or_part1159!==false) {var if_res653 = or_part1159;} else {var if_res653 = subset_p(given_kws1157,allowed_kws1156);}if (if_res653!==false) {var if_res654 = subset_p(req_kws1155,given_kws1157);} else {var if_res654 = false;}var if_res655 = if_res654;} else {var if_res655 = false;}return if_res655;},$rjs_core.attachProcedureArity(function(kws1160, kw_args1161, ...vals1162652) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals1162 = $rjs_core.Pair.listFromArray(vals1162652);return keyword_apply(proc1154,kws1160,kw_args1161,vals1162);}),req_kws1155,allowed_kws1156,proc1154);}var if_res657 = if_res656;} else {var if_res657 = proc1154;}var if_res658 = if_res657;}return if_res658;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_impersonate_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };