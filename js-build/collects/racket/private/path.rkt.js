import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";var path_string_p = function(s114) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part115 = M0.path_p(s114);if (or_part115!==false) {var if_res65 = or_part115;} else {if (M0.string_p(s114)!==false) {var or_part116 = M0.__rjs_quoted__.relative_path_p(s114);if (or_part116!==false) {var if_res63 = or_part116;} else {var if_res63 = M0.__rjs_quoted__.absolute_path_p(s114);}var if_res64 = if_res63;} else {var if_res64 = false;}var if_res65 = if_res64;}return if_res65;};var bsbs = M0.string($rjs_core.Char.charFromCodepoint(92),$rjs_core.Char.charFromCodepoint(92));var normal_case_path = function(s117) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part118 = M0.__rjs_quoted__.path_for_some_system_p(s117);if (or_part118!==false) {var if_res66 = or_part118;} else {var if_res66 = path_string_p(s117);}if (if_res66!==false) {var if_res67 = M0.rvoid();} else {var if_res67 = M0.raise_argument_error($rjs_core.Symbol.make("normal-path-case"),$rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),s117);}if_res67;if (M0.__rjs_quoted__.path_for_some_system_p(s117)!==false) {var if_res68 = M0.eq_p(M0.__rjs_quoted__.path_convention_type(s117),$rjs_core.Symbol.make("windows"));} else {var if_res68 = M0.eq_p(M0.system_type(),$rjs_core.Symbol.make("windows"));}if (if_res68!==false) {if (M0.string_p(s117)!==false) {var if_res69 = false;} else {var if_res69 = M0.__rjs_quoted__.path__gt_bytes(s117);}var bstr119 = if_res69;if (M0.string_p(s117)!==false) {var if_res70 = M0.__rjs_quoted__.regexp_match_p("/^[\\][\\][?][\\]/",s117);} else {var if_res70 = false;}if (if_res70!==false) {var if_res79 = M0.string__gt_path(s117);} else {if (bstr119!==false) {var if_res71 = M0.__rjs_quoted__.regexp_match_p("/^[\\][\\][?][\\]/",bstr119);} else {var if_res71 = false;}if (if_res71!==false) {var if_res78 = s117;} else {var norm120 = function(s123) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.__rjs_quoted__.string_locale_downcase(M0.__rjs_quoted__.regexp_replace_times_("/\\//",s123,bsbs));};var norm_tail121 = function(s124) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.__rjs_quoted__.regexp_match_p("/[\\/\\][. ]+[\\/\\]*$/",s124)!==false) {var if_res72 = s124;} else {var if_res72 = M0.__rjs_quoted__.regexp_replace_times_("/(?<=[^ .\\/\\])[ .]+([\\/\\]*)$/",s124,$rjs_core.UString.make("\\1"));}return if_res72;};var finish122 = function(bstr125) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.__rjs_quoted__.bytes__gt_path(bstr125,$rjs_core.Symbol.make("windows"));};if (M0.string_p(s117)!==false) {var if_res77 = finish122(M0.__rjs_quoted__.string__gt_bytes_by_locale(norm120(norm_tail121(s117))));} else {var c126 = M0.__rjs_quoted__.bytes_open_converter($rjs_core.UString.make(""),$rjs_core.UString.make("UTF-8"));var loop127 = function(offset128) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result73 = M0.__rjs_quoted__.bytes_convert(c126,bstr119,offset128,M0.bytes_length(bstr119));var new_bstr129 = let_result73.getAt(0);var used130 = let_result73.getAt(1);var status131 = let_result73.getAt(2);var s132 = M0.__rjs_quoted__.bytes__gt_string_by_locale(new_bstr129);if (M0.eq_p(status131,$rjs_core.Symbol.make("complete"))!==false) {var if_res74 = norm_tail121(s132);} else {var if_res74 = s132;}var tail_s133 = if_res74;var done134 = M0.__rjs_quoted__.string__gt_bytes_by_locale(norm120(tail_s133));if (M0.eq_p(status131,$rjs_core.Symbol.make("complete"))!==false) {var if_res76 = done134;} else {if (M0.eq_p(status131,$rjs_core.Symbol.make("aborts"))!==false) {var if_res75 = M0.__rjs_quoted__.bytes_append(done134,M0.__rjs_quoted__.subbytes(bstr119,offset128+used130));} else {var if_res75 = M0.__rjs_quoted__.bytes_append(done134,M0.__rjs_quoted__.subbytes(bstr119,offset128+used130,offset128+used130+1),loop127(offset128+used130+1));}var if_res76 = if_res75;}return if_res76;};var if_res77 = finish122(loop127(0));}var if_res78 = if_res77;}var if_res79 = if_res78;}var if_res81 = if_res79;} else {if (M0.string_p(s117)!==false) {var if_res80 = M0.string__gt_path(s117);} else {var if_res80 = s117;}var if_res81 = if_res80;}return if_res81;};var check_extension_call = function(s135, sfx136, who137, sep138, trust_sep_p139) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part142 = M0.__rjs_quoted__.path_for_some_system_p(s135);if (or_part142!==false) {var if_res82 = or_part142;} else {var if_res82 = path_string_p(s135);}if (M0.not(if_res82)!==false) {var if_res88 = M0.values($rjs_core.UString.make("(or/c path-for-some-system? path-string?)"),0);} else {var or_part143 = M0.string_p(sfx136);if (or_part143!==false) {var if_res83 = or_part143;} else {var if_res83 = M0.bytes_p(sfx136);}if (M0.not(if_res83)!==false) {var if_res87 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),1);} else {var or_part144 = trust_sep_p139;if (or_part144!==false) {var if_res85 = or_part144;} else {var or_part145 = M0.string_p(sep138);if (or_part145!==false) {var if_res84 = or_part145;} else {var if_res84 = M0.bytes_p(sep138);}var if_res85 = if_res84;}if (M0.not(if_res85)!==false) {var if_res86 = M0.values($rjs_core.UString.make("(or/c string? bytes?)"),2);} else {var if_res86 = M0.values(false,false);}var if_res87 = if_res86;}var if_res88 = if_res87;}var let_result89 = if_res88;var err_msg140 = let_result89.getAt(0);var err_index141 = let_result89.getAt(1);if (err_msg140!==false) {if (trust_sep_p139!==false) {var if_res90 = M0.raise_argument_error(who137,err_msg140,err_index141,s135,sfx136);} else {var if_res90 = M0.raise_argument_error(who137,err_msg140,err_index141,s135,sfx136,sep138);}var if_res91 = if_res90;} else {var if_res91 = M0.rvoid();}if_res91;var let_result92 = M0.__rjs_quoted__.split_path(s135);var base146 = let_result92.getAt(0);var name147 = let_result92.getAt(1);var dir_p148 = let_result92.getAt(2);if (M0.not(base146)!==false) {var if_res93 = M0.raise_mismatch_error(who137,$rjs_core.UString.make("cannot add an extension to a root path: "),s135);} else {var if_res93 = M0.rvoid();}if_res93;return M0.values(base146,name147);};var path_adjust_extension = function(name149, sep150, rest_bytes151, s152, sfx153, trust_sep_p154) {if (arguments.length!==6) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result94 = check_extension_call(s152,sfx153,name149,sep150,trust_sep_p154);var base155 = let_result94.getAt(0);var name156 = let_result94.getAt(1);var bs157 = M0.__rjs_quoted__.path_element__gt_bytes(name156);var finish158 = function(i159, sep160, i2161) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp99 = M0.__rjs_quoted__.subbytes(bs157,0,i159);if (M0.string_p(sep160)!==false) {var if_res98 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sep160,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res98 = sep160;}var temp97 = rest_bytes151(bs157,i2161);if (M0.string_p(sfx153)!==false) {var if_res96 = M0.__rjs_quoted__.string__gt_bytes_by_locale(sfx153,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res96 = sfx153;}var temp100 = M0.__rjs_quoted__.bytes_append(temp99,if_res98,temp97,if_res96);if (M0.__rjs_quoted__.path_for_some_system_p(s152)!==false) {var if_res95 = M0.__rjs_quoted__.path_convention_type(s152);} else {var if_res95 = M0.__rjs_quoted__.system_path_convention_type();}return M0.__rjs_quoted__.bytes__gt_path_element(temp100,if_res95);};var loop163 = function(i164) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(i164)!==false) {var if_res103 = finish158(M0.bytes_length(bs157),$rjs_core.Bytes.fromIntArray([]),M0.bytes_length(bs157));} else {var i165 = M0.sub1(i164);if (M0.not(M0.zero_p(i165))!==false) {var if_res101 = M0.eq_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46)),M0.bytes_ref(bs157,i165));} else {var if_res101 = false;}if (if_res101!==false) {var if_res102 = finish158(i165,sep150,M0.add1(i165));} else {var if_res102 = loop163(i165);}var if_res103 = if_res102;}return if_res103;};var new_name162 = loop163(M0.bytes_length(bs157));if (M0.__rjs_quoted__.path_for_some_system_p(base155)!==false) {var if_res104 = M0.__rjs_quoted__.build_path(base155,new_name162);} else {var if_res104 = new_name162;}return if_res104;};var path_replace_extension = function(s166, sfx167) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.Symbol.make("path-replace-extension"),$rjs_core.Bytes.fromIntArray([]),function(bs168, i169) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return $rjs_core.Bytes.fromIntArray([]);},s166,sfx167,true);};var cl105 = function(s170, sfx171) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.Symbol.make("path-add-extension"),$rjs_core.Bytes.fromIntArray([95]),M0.__rjs_quoted__.subbytes,s170,sfx171,true);};var cl106 = function(s172, sfx173, sep174) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return path_adjust_extension($rjs_core.Symbol.make("path-add-extension"),sep174,M0.__rjs_quoted__.subbytes,s172,sfx173,false);};var path_add_extension = $rjs_core.attachProcedureArity(function() {var fixed_lam107 = {'2':cl105,'3':cl106}[arguments.length];if (fixed_lam107!==undefined) {return fixed_lam107.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var reroot_path = function(p175, root176) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part177 = path_string_p(p175);if (or_part177!==false) {var if_res108 = or_part177;} else {var if_res108 = M0.__rjs_quoted__.path_for_some_system_p(p175);}if (if_res108!==false) {var if_res109 = M0.rvoid();} else {var if_res109 = M0.raise_argument_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),0,p175,root176);}if_res109;var let_result110 = M0.values();var or_part178 = path_string_p(root176);if (or_part178!==false) {var if_res111 = or_part178;} else {var if_res111 = M0.__rjs_quoted__.path_for_some_system_p(root176);}if (if_res111!==false) {var if_res112 = M0.rvoid();} else {var if_res112 = M0.raise_argument_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("(or/c path-string? path-for-some-system?)"),1,p175,root176);}if_res112;var let_result113 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(p175)!==false) {var if_res114 = M0.__rjs_quoted__.path_convention_type(p175);} else {var if_res114 = M0.__rjs_quoted__.system_path_convention_type();}var conv179 = if_res114;var or_part180 = M0.__rjs_quoted__.complete_path_p(p175);if (or_part180!==false) {var if_res115 = or_part180;} else {var if_res115 = M0.eq_p(M0.__rjs_quoted__.system_path_convention_type(),conv179);}if (if_res115!==false) {var if_res116 = M0.rvoid();} else {var if_res116 = M0.raise_arguments_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("path is not complete and not the platform's convention"),$rjs_core.UString.make("path"),p175,$rjs_core.UString.make("platform convention type"),M0.__rjs_quoted__.system_path_convention_type());}if_res116;var let_result117 = M0.values();if (M0.__rjs_quoted__.path_for_some_system_p(root176)!==false) {var if_res118 = M0.__rjs_quoted__.path_convention_type(root176);} else {var if_res118 = M0.__rjs_quoted__.system_path_convention_type();}if (M0.eq_p(if_res118,conv179)!==false) {var if_res119 = M0.rvoid();} else {var if_res119 = M0.raise_arguments_error($rjs_core.Symbol.make("reroot-path"),$rjs_core.UString.make("given paths use different conventions"),$rjs_core.UString.make("path"),p175,$rjs_core.UString.make("root path"),root176);}if_res119;var let_result120 = M0.values();if (M0.__rjs_quoted__.complete_path_p(p175)!==false) {var if_res121 = p175;} else {var if_res121 = M0.__rjs_quoted__.path__gt_complete_path(p175);}var c_p181 = normal_case_path(M0.__rjs_quoted__.cleanse_path(if_res121));var bstr182 = M0.__rjs_quoted__.path__gt_bytes(c_p181);if (M0.eq_p(conv179,$rjs_core.Symbol.make("unix"))!==false) {if (M0.bytes_eq__p(bstr182,$rjs_core.Bytes.fromIntArray([47]))!==false) {if (M0.__rjs_quoted__.path_for_some_system_p(root176)!==false) {var if_res122 = root176;} else {var if_res122 = M0.string__gt_path(root176);}var if_res123 = if_res122;} else {var if_res123 = M0.__rjs_quoted__.build_path(root176,M0.__rjs_quoted__.bytes__gt_path(M0.__rjs_quoted__.subbytes(M0.__rjs_quoted__.path__gt_bytes(c_p181),1),conv179));}var if_res130 = if_res123;} else {if (M0.eq_p(conv179,$rjs_core.Symbol.make("windows"))!==false) {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\[a-z]:/",bstr182)!==false) {var if_res128 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr182,4,5),$rjs_core.Bytes.fromIntArray([92]),M0.__rjs_quoted__.subbytes(bstr182,6));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr182)!==false) {var if_res127 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr182,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\[?]\\\\UNC\\\\/",bstr182)!==false) {var if_res126 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([92,92,63,92,82,69,76,92]),M0.__rjs_quoted__.subbytes(bstr182,4));} else {if (M0.__rjs_quoted__.regexp_match_p("/^\\\\\\\\/",bstr182)!==false) {var if_res125 = M0.__rjs_quoted__.bytes_append($rjs_core.Bytes.fromIntArray([85,78,67,92]),M0.__rjs_quoted__.subbytes(bstr182,2));} else {if (M0.__rjs_quoted__.regexp_match_p("/^[a-z]:/",bstr182)!==false) {var if_res124 = M0.__rjs_quoted__.bytes_append(M0.__rjs_quoted__.subbytes(bstr182,0,1),M0.__rjs_quoted__.subbytes(bstr182,2));} else {var if_res124 = M0.rvoid();}var if_res125 = if_res124;}var if_res126 = if_res125;}var if_res127 = if_res126;}var if_res128 = if_res127;}var if_res129 = M0.__rjs_quoted__.build_path(root176,M0.__rjs_quoted__.bytes__gt_path(if_res128,conv179));} else {var if_res129 = M0.rvoid();}var if_res130 = if_res129;}return if_res130;};var __rjs_quoted__ = {};export { __rjs_quoted__,reroot_path,path_add_extension,path_replace_extension,normal_case_path,path_string_p };